<style>
    body, html {
        height: 100%;
    }

    body {
        margin: 0;
        padding: 0;
        border: 0;
    }

    .footer {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 30px;
        background-color: #f5f5f5;
    }

    table, th, td {
        border: 1px solid black;
        border-collapse: collapse;
    }

    th, td {
        padding: 5px;
        text-align: left;
    }

    p {
        text-orientation: upright;
        writing-mode: vertical-lr;
    }

    centerP {
        display: flex;
        justify-content: center;
        align-items: center;
        writing-mode: vertical-lr;
        text-orientation: upright;
        height: 50em;
    }

    .loader {
        position: fixed;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        z-index: 9999;
        background: Url("/Content/images/pageLoader.gif") 50% 50% no-repeat rgb(249,249,249);
        opacity: .8;
    }
</style>

@{
    ViewBag.Title = "Dashboard";
    Layout = "~/Views/Shared/_Layout.cshtml";

}

<body>
    <div class="container">
        <br />
        <div class="row">
            <div class="col-sm-2">
                <label for="lbl1">Periode :</label>
            </div>
            <div class="col-sm-2">
                @if (Session["UserType"] != null)
                {
                    var author = Session["UserType"];
                    <input type="hidden" class="form-control" id="authorid" placeholder="YYYY" value=@author />
                }
                <div class="input-group date datetimepicker">
                    <input type="text" class="form-control" id="prd" placeholder="YYYY" />
                    <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                </div>

            </div>
            <div class="col-sm-2">
                <button id="periode" type="button" class="btn btn-danger btn-md" data-toggle="tooltip" title="View" onclick="GetPeriode();">Table</button>
            </div>
            <div class="col-sm-3">
                <select class="form-control" id="monthkpi">
                    <option value="1">JANUARY</option>
                    <option value="2">FEBRUARY</option>
                    <option value="3">MARCH</option>
                    <option value="4">APRIL</option>
                    <option value="5">MAY</option>
                    <option value="6">JUNE</option>
                    <option value="7">JULY</option>
                    <option value="8">AUGUSTUS</option>
                    <option value="9">SEPTEMBER</option>
                    <option value="10">OCTOBER</option>
                    <option value="11">NOVEMBER</option>
                    <option value="12">DECEMBER</option>
                </select>
            </div>
            <div class="col-sm-2">
                <button id="month" type="button" class="btn btn-danger btn-md" data-toggle="tooltip" title="View" onclick="GetMonth();">Table</button>
            </div>
            <div class="col-sm-1">
                <button id="simpan" type="button" class="btn btn-danger btn-md" data-toggle="tooltip" title="Save" onclick="GetSave();">Save</button>
            </div>
        </div>
        <br />
        <div id="detailForm" class="form-horizontal">
            <br />
            <table id="DetailInfo" class="table table-bordered  table-hover">
                <caption id="thn" class="text-center" style="background-color: #4d79ff;color: white;">Year :</caption>
                <tbody id="tbodytblDetailInfo">
                    <tr>
                        <th style="background-color: #4d79ff;color: white;"><b>DEPARTMENT</b></th>
                        <th style="background-color: #4d79ff;color: white;"><b>DESCRIPTION</b></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>WEIGHT</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>TARGET</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>ACTUAL</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>ACHIEVEMENT</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>SCORE</b></span></th>
                    </tr>
                    <tr>
                        <th rowspan="18" class="text-center"><a href="javascript:void(0)" data-toggle="tooltip" title="Monthly" onclick="Monthly()"><b>CASTING</b></a></th>
                        <td style="font-size:x-small"><span id="RevTitle">Revenue</span></td>
                        <td><span id="CasGrdRev" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtRev" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActRev" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchRev" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrRev" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdr" style="display:none;">
                        <td><span id="OutTitle">Output Pouring</span></td>
                        <td><span id="CasGrdOut" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtOut" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActOut" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchOut" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrOut" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="PdaTitle">Production Output PDA</span></td>
                        <td><span id="CasGrdPda" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtPda" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActPda" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchPda" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrPda" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrdrm">
                        <td style="font-size:x-small"><span id="DrmTitle">DRM Average</span></td>
                        <td><span id="CasGrdDrm" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtDrm" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActDrm" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchDrm" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrDrm" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="RejTitle">Reject Rate at mfg.site(%)</span></td>
                        <td><span id="CasGrdRej" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtRej" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActRej" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchRej" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrRej" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="BadTitle">Reject Rate at mfg.site-Bad Casting(%)</span></td>
                        <td><span id="CasGrdBad" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtBad" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActBad" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchBad" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrBad" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="ScpTitle">Budget - Konstanta Scrap Used(%) of PDA</span></td>
                        <td><span id="CasGrdScp" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtScp" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActScp" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchScp" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrScp" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="AlyTitle">Budget - Konstanta Alloys Used(%) of PDA</span></td>
                        <td><span id="CasGrdAly" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtAly" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActAly" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchAly" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrAly" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="SilTitle">Budget - Konstanta Colloidal Silica Used(%) of PDA</span></td>
                        <td><span id="CasGrdSil" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtSil" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActSil" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchSil" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrSil" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="ZifTitle">Budget - Konstanta Zircon Flour 325 Used(%) of PDA</span></td>
                        <td><span id="CasGrdZif" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtZif" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActZif" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchZif" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrZif" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="ZisTitle">Budget - Konstanta Zircon Sands 110 Used(%) of PDA</span></td>
                        <td><span id="CasGrdZis" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtZis" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActZis" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchZis" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrZis" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="MufTitle">Budget - Konstanta Mullite Flour 200 Used(%) of PDA</span></td>
                        <td><span id="CasGrdMuf" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtMuf" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActMuf" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchMuf" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrMuf" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="Mu3Title">Budget - Konstanta Mullite Sands 30-80 Used(%) of PDA</span></td>
                        <td><span id="CasGrdMu3" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtMu3" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActMu3" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchMu3" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrMu3" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="Mu1Title">Budget - Konstanta Mullite Sands 15-30 Used(%) of PDA</span></td>
                        <td><span id="CasGrdMu1" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtMu1" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActMu1" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchMu1" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrMu1" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrrat">
                        <td style="font-size:x-small"><span id="RatTitle">Reject Rate at Cust.site(%)</span></td>
                        <td><span id="CasGrdRat" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtRat" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActRat" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchRat" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrRat" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrmat">
                        <td style="font-size:x-small"><span id="MatTitle">Prod. Cost Control - Material</span></td>
                        <td><span id="CasGrdMat" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtMat" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActMat" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchMat" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrMat" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="ConTitle">Prod. Cost Control - Consumables</span></td>
                        <td><span id="CasGrdCon" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtCon" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActCon" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchCon" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrCon" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="FohTitle">Prod. Cost Control - FOH Electricity</span></td>
                        <td><span id="CasGrdFoh" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtFoh" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActFoh" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchFoh" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrFoh" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="NonTitle">Prod. Cost Control - FOH Non Electricity(Fixed)</span></td>
                        <td><span id="CasGrdNon" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtNon" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActNon" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchNon" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrNon" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="LabTitle">Prod. Cost Control - Labor Cost</span></td>
                        <td><span id="CasGrdLab" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtLab" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActLab" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchLab" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrLab" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrred">
                        <td style="font-size:x-small"><span id="RedTitle">Cost Reduction</span></td>
                        <td><span id="CasGrdRed" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtRed" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActRed" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchRed" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrRed" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="WipTitle">WIP Control - Wax - Ceramic</span></td>
                        <td><span id="CasGrdWip" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtWip" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActWip" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchWip" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrWip" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrsaf">
                        <td style="font-size:x-small"><span id="SafTitle">Safety at production workplace</span></td>
                        <td><span id="CasGrdSaf" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtSaf" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActSaf" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchSaf" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrSaf" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span class="pull-right" style="color:blue"><b>Total Weight</b></span></td>
                        <td><span id="PicGrdTot" class="pull-right" style="color:blue;font-weight:bold"></span></td>
                        <td><span></span></td>
                        <td><span></span></td>
                        <td><span class="pull-right" style="color:blue"><b>Total Score</b></span></td>
                        <td><span id="PicScrTot" class="pull-right" style="color:blue;font-weight:bold"></span></td>
                    </tr>
                </tbody>
            </table>
            <br />
            <br />
            <br />
            <br />
        </div>

        <div id="monthlyForm" class="form-horizontal">
            <br />
            <table id="monthlyInfo" class="table table-bordered  table-hover">
                <caption id="blnnan" class="text-center" style="background-color: #4d79ff;color: white;">MONTH : </caption>
                <tbody id="tbodytblMonthlyInfo">
                    <tr>
                        <th style="background-color: #4d79ff;color: white;"><b>DEPARTMENT</b></th>
                        <th style="background-color: #4d79ff;color: white;"><b>DESCRIPTION</b></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>WEIGHT</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>TARGET</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>ACTUAL</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>ACHIEVEMENT</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>SCORE</b></span></th>
                    </tr>
                    <tr>
                        <th rowspan="18" class="text-center"><a href="javascript:void(0)" data-toggle="tooltip" title="Monthly" onclick="Yearly()"><b>CASTING</b></a></th>
                        <td style="font-size:x-small"><span id="RevTitleMonth">Revenue</span></td>
                        <td><span id="CasGrdRevMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtRevMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActRevMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchRevMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrRevMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trdtl" style="display:none">
                        <td><span id="OutTitleMonth">Output Pouring</span></td>
                        <td><span id="CasGrdOutMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtOutMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActOutMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchOutMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrOutMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="PdaTitleMonth">Production Output PDA</span></td>
                        <td><span id="CasGrdPdaMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtPdaMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActPdaMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchPdaMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrPdaMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrdrmMonth">
                        <td style="font-size:x-small"><span id="DrmTitleMonth">DRM Average</span></td>
                        <td><span id="CasGrdDrmMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtDrmMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActDrmMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchDrmMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrDrmMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="RejTitleMonth">Reject Rate at mfg.site(%)</span></td>
                        <td><span id="CasGrdRejMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtRejMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActRejMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchRejMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrRejMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="BadTitleMonth">Reject Rate at mfg.site-Bad Casting(%)</span></td>
                        <td><span id="CasGrdBadMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtBadMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActBadMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchBadMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrBadMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="ScpTitleMonth">Budget - Konstanta Scrap Used(%) of PDA</span></td>
                        <td><span id="CasGrdScpMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtScpMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActScpMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchScpMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrScpMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="AlyTitleMonth">Budget - Konstanta Alloys Used(%) of PDA</span></td>
                        <td><span id="CasGrdAlyMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtAlyMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActAlyMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchAlyMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrAlyMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="SilTitleMonth">Budget - Konstanta Colloidal Silica Used(%) of PDA</span></td>
                        <td><span id="CasGrdSilMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtSilMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActSilMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchSilMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrSilMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="ZifTitleMonth">Budget - Konstanta Zircon Flour 325 Used(%) of PDA</span></td>
                        <td><span id="CasGrdZifMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtZifMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActZifMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchZifMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrZifMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="ZisTitleMonth">Budget - Konstanta Zircon Sands 110 Used(%) of PDA</span></td>
                        <td><span id="CasGrdZisMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtZisMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActZisMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchZisMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrZisMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="MufTitleMonth">Budget - Konstanta Mullite Flour 200 Used(%) of PDA</span></td>
                        <td><span id="CasGrdMufMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtMufMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActMufMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchMufMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrMufMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="Mu3TitleMonth">Budget - Konstanta Mullite Sands 30-80 Used(%) of PDA</span></td>
                        <td><span id="CasGrdMu3Month" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtMu3Month" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActMu3Month" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchMu3Month" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrMu3Month" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="Mu1TitleMonth">Budget - Konstanta Mullite Sands 15-30 Used(%) of PDA</span></td>
                        <td><span id="CasGrdMu1Month" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtMu1Month" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActMu1Month" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchMu1Month" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrMu1Month" class="pull-right" style="color:blue"></span></td>
                    </tr>

                    <tr id="trhdrratMonth">
                        <td style="font-size:x-small"><span id="RatTitleMonth">Reject Rate at Cust.site(%)</span></td>
                        <td><span id="CasGrdRatMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtRatMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActRatMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchRatMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrRatMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrmatMonth">
                        <td style="font-size:x-small"><span id="MatTitleMonth">Prod. Cost Control - Material</span></td>
                        <td><span id="CasGrdMatMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtMatMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActMatMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchMatMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrMatMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="ConTitleMonth">Prod. Cost Control - Consumables</span></td>
                        <td><span id="CasGrdConMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtConMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActConMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchConMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrConMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="FohTitleMonth">Prod. Cost Control - FOH Electricity</span></td>
                        <td><span id="CasGrdFohMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtFohMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActFohMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchFohMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrFohMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="NonTitleMonth">Prod. Cost Control - FOH Non Electricity</span></td>
                        <td><span id="CasGrdNonMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtNonMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActNonMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchNonMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrNonMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>

                    <tr>
                        <td style="font-size:x-small"><span id="LabTitleMonth">Prod. Cost Control - Labor Cost</span></td>
                        <td><span id="CasGrdLabMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtLabMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActLabMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchLabMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrLabMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrredMonth">
                        <td style="font-size:x-small"><span id="RedTitleMonth">Cost Reduction</span></td>
                        <td><span id="CasGrdRedMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtRedMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActRedMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchRedMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrRedMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="WipTitleMonth">WIP Control - Wax - Ceramic</span></td>
                        <td><span id="CasGrdWipMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtWipMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActWipMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchWipMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrWipMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrsafMonth">
                        <td style="font-size:x-small"><span id="SafTitleMonth">Safety at production workplace</span></td>
                        <td><span id="CasGrdSafMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtSafMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActSafMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchSafMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrSafMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>

                    <tr>
                        <td><span class="pull-right" style="color:blue"><b>Total Weight</b></span></td>
                        <td><span id="PicGrdTotMonth" class="pull-right" style="color:blue;font-weight:bold"></span></td>
                        <td><span></span></td>
                        <td><span></span></td>
                        <td><span class="pull-right" style="color:blue"><b>Total Score</b></span></td>
                        <td><span id="PicScrTotMonth" class="pull-right" style="color:blue;font-weight:bold"></span></td>
                    </tr>

                </tbody>
            </table>
            <br />
            <br />
            <br />
            <br />
        </div>

        <div id="childForm" class="form-horizontal">
            <br />
            <table id="childInfo" class="table table-bordered  table-hover">
                <caption id="thnnan" class="text-center" style="background-color: #4d79ff;color: white;">YEAR TO DATE</caption>
                <tbody id="tbodytblChildInfo">
                    <tr>
                        <th style="background-color: #4d79ff;color: white;"><b>DEPARTMENT</b></th>
                        <th style="background-color: #4d79ff;color: white;"><b>DESCRIPTION</b></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>WEIGHT</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>TARGET</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>ACTUAL</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>ACHIEVEMENT</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>SCORE</b></span></th>
                    </tr>
                    <tr>
                        <th rowspan="18" class="text-center"><a href="javascript:void(0)" data-toggle="tooltip" title="Monthly" onclick="Monthly()"><b>CASTING</b></a></th>
                        <td style="font-size:x-small"><span id="RevTitleSum">Revenue</span></td>
                        <td><span id="CasGrdRevSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtRevSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActRevSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchRevSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrRevSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trsubdtl" style="display:none">
                        <td><span id="OutTitleSum">Output Pouring</span></td>
                        <td><span id="CasGrdOutSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtOutSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActOutSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchOutSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrOutSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="PdaTitleSum">Production Output PDA</span></td>
                        <td><span id="CasGrdPdaSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtPdaSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActPdaSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchPdaSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrPdaSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrdrmSum">
                        <td style="font-size:x-small"><span id="DrmTitleSum">DRM Average</span></td>
                        <td><span id="CasGrdDrmSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtDrmSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActDrmSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchDrmSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrDrmSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="RejTitleSum">Reject Rate at mfg.site(%)</span></td>
                        <td><span id="CasGrdRejSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtRejSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActRejSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchRejSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrRejSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="BadTitleSum">Reject Rate at mfg.site-Bad Casting(%)</span></td>
                        <td><span id="CasGrdBadSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtBadSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActBadSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchBadSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrBadSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="ScpTitleSum">Budget - Konstanta Scrap Used(%) of PDA</span></td>
                        <td><span id="CasGrdScpSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtScpSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActScpSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchScpSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrScpSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="AlyTitleSum">Budget - Konstanta Alloys Used(%) of PDA</span></td>
                        <td><span id="CasGrdAlySum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtAlySum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActAlySum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchAlySum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrAlySum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="SilTitleSum">Budget - Konstanta Colloidal Silica Used(%) of PDA</span></td>
                        <td><span id="CasGrdSilSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtSilSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActSilSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchSilSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrSilSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="ZifTitleSum">Budget - Konstanta Zircon Flour 325 Used(%) of PDA</span></td>
                        <td><span id="CasGrdZifSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtZifSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActZifSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchZifSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrZifSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="ZisTitleSum">Budget - Konstanta Zircon Sands 110 Used(%) of PDA</span></td>
                        <td><span id="CasGrdZisSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtZisSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActZisSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchZisSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrZisSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="MufTitleSum">Budget - Konstanta Mullite Flour 200 Used(%) of PDA</span></td>
                        <td><span id="CasGrdMufSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtMufSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActMufSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchMufSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrMufSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="Mu3TitleSum">Budget - Konstanta Mullite Sands 30-80 Used(%) of PDA</span></td>
                        <td><span id="CasGrdMu3Sum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtMu3Sum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActMu3Sum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchMu3Sum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrMu3Sum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:xx-small"><span id="Mu1TitleSum">Budget - Konstanta Mullite Sands 15-30 Used(%) of PDA</span></td>
                        <td><span id="CasGrdMu1Sum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtMu1Sum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActMu1Sum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchMu1Sum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrMu1Sum" class="pull-right" style="color:blue"></span></td>
                    </tr>

                    <tr id="trhdrratSum">
                        <td style="font-size:x-small"><span id="RatTitleSum">Reject Rate at Cust.site(%)</span></td>
                        <td><span id="CasGrdRatSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtRatSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActRatSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchRatSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrRatSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrmatSum">
                        <td style="font-size:x-small"><span id="MatTitleSum">Prod. Cost Control - Material</span></td>
                        <td><span id="CasGrdMatSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtMatSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActMatSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchMatSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrMatSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="ConTitleSum">Prod. Cost Control - Consumables</span></td>
                        <td><span id="CasGrdConSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtConSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActConSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchConSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrConSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="FohTitleSum">Prod. Cost Control - FOH Electricity</span></td>
                        <td><span id="CasGrdFohSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtFohSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActFohSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchFohSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrFohSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="NonTitleSum">Prod. Cost Control - FOH Non Electricity</span></td>
                        <td><span id="CasGrdNonSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtNonSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActNonSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchNonSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrNonSum" class="pull-right" style="color:blue"></span></td>
                    </tr>

                    <tr>
                        <td style="font-size:x-small"><span id="LabTitleSum">Prod. Cost Control - Labor Cost</span></td>
                        <td><span id="CasGrdLabSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtLabSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActLabSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchLabSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrLabSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrredSum">
                        <td style="font-size:x-small"><span id="RedTitleSum">Cost Reduction</span></td>
                        <td><span id="CasGrdRedSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtRedSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActRedSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchRedSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrRedSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td style="font-size:x-small"><span id="WipTitleSum">WIP Control - Wax - Ceramic</span></td>
                        <td><span id="CasGrdWipSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtWipSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActWipSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchWipSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrWipSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr id="trhdrsafSum">
                        <td style="font-size:x-small"><span id="SafTitleSum">Safety at production workplace</span></td>
                        <td><span id="CasGrdSafSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasTgtSafSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasActSafSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasAchSafSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="CasScrSafSum" class="pull-right" style="color:blue"></span></td>
                    </tr>

                    <tr>
                        <td><span class="pull-right" style="color:blue"><b>Total Weight</b></span></td>
                        <td><span id="PicGrdTotSum" class="pull-right" style="color:blue;font-weight:bold"></span></td>
                        <td><span></span></td>
                        <td><span></span></td>
                        <td><span class="pull-right" style="color:blue"><b>Total Score</b></span></td>
                        <td><span id="PicScrTotSum" class="pull-right" style="color:blue;font-weight:bold"></span></td>
                    </tr>

                </tbody>
            </table>
            <br />
            <br />
            <br />
            <br />
        </div>
        <div class="loader"></div>
    </div>
</body>
<script>
    var urlKPI = "@Url.Content("~/Dashboard")";
    var TempAmountLab = 0;
    var TempGradeLab = 0;
    var TempTargetLab = 0;
    var TempGradeSaf = 0;
    var TempTargetSaf = 0;
    var TempGradeSafMonth = 0;
    var TempTargetSafMonth = 0;
    var TempGradeSafSum = 0;
    var TempTargetSafSum = 0;
    var PicScrTot = 0;
    var PicScrTotMonth = 0;
    var PicScrTotSum = 0;
    var PicTotGrade = 0, PicTotGradeMonth = 0, PicTotGradeSum = 0;

    $(document).ready(function () {
        $('.datetimepicker').datetimepicker({
            format: 'YYYY'
        });
        $('#month').hide();
        $('#monthlyForm').hide();
        $('#childForm').hide();
        $('#monthkpi').hide();
        $('#simpan').hide();
        var userAu = $('#authorid').val();
        if (userAu == "VST") {
            $("#RevTitle").text('');
            $("#RevTitleMonth").text('');
            $("#RevTitleSum").text('');
        }

        var dNow = new Date();
        iMonth = dNow.getMonth() + 1;
        var iYear = dNow.getFullYear();
        $('#prd').val(iYear);
        $('#thn').text('YEAR : ' + iYear);

        getView(iYear);
    });

    function GetSave() {
        var kpiRpt = {
            Bulan: $('#monthkpi').val(),
            Tahun: $('#prd').val(),
            Title: 'Casting',
            Nilai: $('#PicScrTotMonth').text(),
            ch: 'I'
        }
        $.ajax({
            url: urlKPI + "/ShowProdOPlean",
            data: JSON.stringify(kpiRpt),
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                if (result > 0) {
                    BootstrapAlert.success({
                        title: "Message",
                        message: "save Successfull..."
                    });
                    update = 0;
                    getLoad();
                } else {
                    BootstrapAlert.alert({
                        title: "Message",
                        message: "Save Failed..."
                    });

                }
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });
    }

    function GetPeriode() {
        var newyear = $('#prd').val();
        $('#thn').text('YEAR : ' + newyear);
        getView(newyear);
    }

    function GetMonth() {
        var newyear = $('#prd').val();
        var newmonth = $('#monthkpi').val();       
        getMonthView(newyear, newmonth);
    }

    function Monthly() {
        $('#month').show();
        $('#monthlyForm').show();
        $('#childForm').show();
        $('#detailForm').hide();
        $('#periode').hide();
        $('#monthkpi').show();
        $('#simpan').show();
       
    }

    function Yearly() {
        $('#simpan').hide();
        $('#month').hide();
        $('#monthlyForm').hide();
        $('#childForm').hide();
        $('#detailForm').show();
        $('#periode').show();
        $('#monthkpi').hide();
    }

    function valMonth(bl) {
        var nmonth;
        switch (bl) {
            case '1':
                nmonth = "JANUARY";
                break;
            case '2':
                nmonth = "FEBRUARY";
                break;
            case '3':
                nmonth = "MARCH";
                break;
            case '4':
                nmonth = "APRIL";
                break;
            case '5':
                nmonth = "MAY";
                break;
            case '6':
                nmonth = "JUNE";
                break;
            case '7':
                nmonth = "JULY";
                break;
            case '8':
                nmonth = "AUGUSTUS";
                break;
            case '9':
                nmonth = "SEPTEMBER";
                break;
            case '10':
                nmonth = "OCTOBER";
                break;
            case '11':
                nmonth = "NOVEMBER";
                break;
            case '12':
                nmonth = "DECEMBER";
                break;
            default:
                nmonth = "KABISAT";
                // code block
        }
        return nmonth;
    }

    function formatNumber(num) {
        return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,")
    }

    function getView(thn) {      
        PicScrTot = 0;
        PicTotGrade = 0;
        var userAu = $('#authorid').val();
       var kpiObj = {
            id: thn,
            bln: iMonth
        }
        $.ajax({
            url: urlKPI + "/vCastingDept/",
            data: JSON.stringify(kpiObj),
            contentType: "application/json;charset=utf-8",
            success: function (result) {
                $.each(result, function (key, item) {
                    if (userAu != "VST") {
                        $("#CasGrdRev").text(formatNumber(item.PicGrdRev));
                        $("#CasTgtRev").text(formatNumber(item.PicTgtRev));
                        $("#CasActRev").text(formatNumber(item.PicActRev));
                        $("#CasAchRev").text(formatNumber(item.PicAchRev.toFixed(2)));
                        $("#CasScrRev").text(formatNumber(item.PicScrRev.toFixed(2)));
                        var PicGrdRev = item.PicGrdRev;
                        var PicTgtRev = item.PicTgtRev;
                        if (PicGrdRev == 0)
                            $("#RevTitle").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor = item.PicScrRev - item.PicGrdRev;
                            if (newcolor >= 0 && item.PicTgtRev > 0)
                                $("#RevTitle").css({ "color": "black", "font-weight": "bold" });
                            else $("#RevTitle").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTot = PicScrTot + item.PicScrRev;
                        PicTotGrade = PicTotGrade + item.PicGrdRev;
                    }
                    if (thn < 2022) {
                        $('#trhdrrat').show();
                        $('#trhdrdrm').show();
                        $('#trhdrmat').show();
                        $('#trhdrred').show();
                        $('#trhdrsaf').show();

                        /*------------reject rate at cust---------*/
                        $("#CasGrdRat").text(formatNumber(item.PicGrdRjt));
                        $("#CasTgtRat").text(formatNumber(item.PicTgtRjt));
                        $("#CasActRat").text(formatNumber(item.PicActRjt));
                        $("#CasAchRat").text(formatNumber(item.PicAchRjt.toFixed(2)));
                        $("#CasScrRat").text(formatNumber(item.PicScrRjt.toFixed(2)));
                        var PicGrdRjt = item.PicGrdRjt;
                        var PicTgtRjt = item.PicTgtRjt;
                        if (PicGrdRjt == 0)
                            $("#RatTitle").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor11 = item.PicScrRjt - item.PicGrdRjt;
                            if (newcolor11 >= 0 && item.PicTgtRjt > 0)
                                $("#RatTitle").css({ "color": "black", "font-weight": "bold" });
                            else $("#RatTitle").css({ "color": "red", "font-weight": "bold" });
                        }

                        PicScrTot = PicScrTot + item.PicScrRjt;
                        PicTotGrade = PicTotGrade + item.PicGrdRjt;

                        /*------------Drm---------*/
                        $("#CasGrdDrm").text(formatNumber(item.PicGrdAir));
                        $("#CasTgtDrm").text(formatNumber(item.PicTgtAir));
                        $("#CasActDrm").text(formatNumber(item.PicActAir));
                        $("#CasAchDrm").text(formatNumber(item.PicAchAir.toFixed(2)));
                        $("#CasScrDrm").text(formatNumber(item.PicScrAir.toFixed(2)));
                        var PicGrdAir = item.PicGrdAir;
                        var PicTgtAir = item.PicTgtAir;
                        if (PicGrdAir == 0)
                            $("#DrmTitle").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor3 = item.PicScrAir - item.PicGrdAir;
                            if (newcolor3 >= 0 && item.PicTgtAir > 0)
                                $("#DrmTitle").css({ "color": "black", "font-weight": "bold" });
                            else $("#DrmTitle").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTot = PicScrTot + item.PicScrAir;
                        PicTotGrade = PicTotGrade + item.PicGrdAir;

                        /*------------prod.cost control material---------*/
                        $("#CasGrdMat").text(formatNumber(item.PicGrdMus));
                        $("#CasTgtMat").text(formatNumber(item.PicTgtMus));
                        $("#CasActMat").text(formatNumber(item.PicActMus));
                        $("#CasAchMat").text(formatNumber(item.PicAchMus.toFixed(2)));
                        $("#CasScrMat").text(formatNumber(item.PicScrMus.toFixed(2)));
                        var PicGrdMus = item.PicGrdMus;
                        var PicTgtMus = item.PicTgtMus;
                        if (PicGrdMus == 0)
                            $("#MatTitle").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor10 = item.PicScrMus - item.PicGrdMus;
                            if (newcolor10 >= 0 && item.PicTgtMus > 0)
                                $("#MatTitle").css({ "color": "black", "font-weight": "bold" });
                            else $("#MatTitle").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTot = PicScrTot + item.PicScrMus;
                        PicTotGrade = PicTotGrade + item.PicGrdMus;

                        //----REDUCTION
                        $("#CasGrdRed").text(formatNumber(item.PicGrdEme));
                        $("#CasTgtRed").text(formatNumber(item.PicTgtEme));
                        $("#CasActRed").text(formatNumber(item.PicActEme));
                        $("#CasAchRed").text(formatNumber(item.PicAchEme.toFixed(2)));
                        $("#CasScrRed").text(formatNumber(item.PicScrEme.toFixed(2)));
                        var PicGrdEme = item.PicGrdEme;
                        var PicTgtEme = item.PicTgtEme;
                        if (PicGrdEme == 0)
                            $("#RedTitle").css({ "color": "black", "font-weight": "normal" });
                        else {
                            //item.PicScrEme - item.PicScrEme;  ganti di sini
                            var newcolor8 = item.PicScrEme - item.PicGrdEme;
                            if (newcolor8 >= 0 && item.PicTgtEme > 0)
                                $("#RedTitle").css({ "color": "black", "font-weight": "bold" });
                            else $("#RedTitle").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTot = PicScrTot + item.PicScrEme;
                        PicTotGrade = PicTotGrade + item.PicGrdEme;
                        //----Safety Index
                        $("#CasGrdSaf").text(formatNumber(item.PicGrdSaf));
                        $("#CasTgtSaf").text(formatNumber(item.PicTgtSaf));
                        TempGradeSaf = item.PicGrdSaf;
                        TempTargetSaf = item.PicTgtSaf;
                        PicTotGrade = PicTotGrade + item.PicGrdSaf;

                        var kpiHRD = {
                            id: thn,
                            bln: iMonth,
                            ch: 'D'
                        }
                        $.ajax({
                            url: urlKPI + "/CastingDept/",
                            data: JSON.stringify(kpiHRD),
                            contentType: "application/json;charset=utf-8",
                            success: function (result) {
                                $.each(result, function (key, item) {
                                    /*-- safety index -----------*/
                                    var MacActSaf = item.ibpActSafe;
                                    $("#CasActSaf").text(formatNumber(MacActSaf.toFixed(2)));
                                    $("#CasAchSaf").text(formatNumber(item.PicAchSaf.toFixed(2)));
                                    $("#CasScrSaf").text(formatNumber(item.PicScrSaf.toFixed(2)));
                                    console.log(MacActSaf);
                                    if (TempGradeSaf == 0)
                                        $("#SafTitle").css({ "color": "black", "font-weight": "normal" });
                                    else {
                                        if (MacActSaf == 0)
                                            $("#SafTitle").css({ "color": "black", "font-weight": "bold" });
                                        else $("#SafTitle").css({ "color": "red", "font-weight": "bold" });
                                    }
                                    PicScrTot = PicScrTot + item.PicScrSaf;
                                    /*----------- TOTAL  ------------*/
                                    //$("#PicGrdTot").text(formatNumber(PicTotGrade.toFixed(2)));
                                    //$("#PicScrTot").text(formatNumber(PicScrTot.toFixed(2)));


                                });
                            },
                            error: function (errormessage) {
                                alert(errormessage.responseText);
                            },
                            beforeSend: function () { $(".loader").show(); },
                            complete: function () { $(".loader").hide(); },
                            type: 'POST', dataType: 'json'
                        });


                    } else {
                        $('#trhdrrat').hide();
                        $('#trhdrdrm').hide();
                        $('#trhdrmat').hide();
                        $('#trhdrred').hide();
                        $('#trhdrsaf').hide();

                    }


                    /*------------output pouring---------*/
                    if (thn < 2020) {
                        $("#trhdr").show();
                        $("#CasGrdOut").text(formatNumber(item.PicGrdTvb));
                        $("#CasTgtOut").text(formatNumber(item.PicTgtTvb));
                        $("#CasActOut").text(formatNumber(item.PicActTvb));
                        $("#CasAchOut").text(formatNumber(item.PicAchTvb.toFixed(2)));
                        $("#CasScrOut").text(formatNumber(item.PicScrTvb.toFixed(2)));
                        var PicGrdTvb = item.PicGrdTvb;
                        var PicTgtTvb = item.PicTgtTvb;
                        console.log(PicTgtTvb);
                        if (PicGrdTvb == 0)
                            $("#OutTitle").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor10 = item.PicScrTvb - item.PicGrdTvb;
                            if (newcolor10 >= 0 && item.PicTgtTvb > 0)
                                $("#OutTitle").css({ "color": "black", "font-weight": "bold" });
                            else $("#OutTitle").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTot = PicScrTot + item.PicScrTvb;
                        PicTotGrade = PicTotGrade + item.PicGrdTvb;

                    }
                    else {
                        $("#trhdr").hide();
                    }

                    /*------------pda---------*/
                    $("#CasGrdPda").text(formatNumber(item.PicGrdPda));
                    $("#CasTgtPda").text(formatNumber(item.PicTgtPda));
                    $("#CasActPda").text(formatNumber(item.PicActPda));
                    $("#CasAchPda").text(formatNumber(item.PicAchPda.toFixed(2)));
                    $("#CasScrPda").text(formatNumber(item.PicScrPda.toFixed(2)));
                    var PicGrdPda = item.PicGrdPda;
                    var PicTgtPda = item.PicTgtPda;
                    if (PicGrdPda == 0 )
                        $("#PdaTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor1 = item.PicScrPda - item.PicGrdPda;
                        if (newcolor1 >= 0 && item.PicTgtPda > 0)
                            $("#PdaTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#PdaTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrPda;
                    PicTotGrade = PicTotGrade + item.PicGrdPda;

                    /*------------labor cost ---------*/
                    $("#CasGrdLab").text(formatNumber(item.PicGrdPdc));
                    $("#CasTgtLab").text(formatNumber(item.PicTgtPdc));
                    $("#CasActLab").text(formatNumber(item.PicActPdc.toFixed(2)));
                    $("#CasAchLab").text(formatNumber(item.PicAchPdc.toFixed(2)));
                    $("#CasScrLab").text(formatNumber(item.PicScrPdc.toFixed(2)));
                    var PicGrdPdc = item.PicGrdPdc;
                    var PicTgtPdc = item.PicTgtPdc;
                    if (PicGrdPdc == 0 )
                        $("#LabTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorLab = item.PicScrPdc - item.PicGrdPdc;
                        if (newcolorLab >= 0)
                            $("#LabTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#LabTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrPdc;
                    PicTotGrade = PicTotGrade + item.PicGrdPdc;
                    //---- reject rate casting
                    $("#CasGrdRej").text(formatNumber(item.PicGrdOth));
                    $("#CasTgtRej").text(formatNumber(item.PicTgtOth));
                    $("#CasActRej").text(formatNumber(item.PicActOth));
                    $("#CasAchRej").text(formatNumber(item.PicAchOth.toFixed(2)));
                    $("#CasScrRej").text(formatNumber(item.PicScrOth.toFixed(2)));
                    var PicGrdOth = item.PicGrdOth;
                    var PicTgtOth = item.PicTgtOth;
                    if (PicGrdOth == 0 )
                        $("#RejTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor4 = item.PicScrOth - item.PicGrdOth;
                        if (newcolor4 >= 0 && item.PicTgtOth > 0)
                            $("#RejTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#RejTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrOth;
                    PicTotGrade = PicTotGrade + item.PicGrdOth;
                    //---- wip
                    $("#CasGrdWip").text(formatNumber(item.PicGrdSca));
                    $("#CasTgtWip").text(formatNumber(item.PicTgtSca));
                    $("#CasActWip").text(formatNumber(item.PicActSca));
                    $("#CasAchWip").text(formatNumber(item.PicAchSca.toFixed(2)));
                    $("#CasScrWip").text(formatNumber(item.PicScrSca.toFixed(2)));
                    var PicGrdSca = item.PicGrdSca;
                    var PicTgtSca = item.PicTgtSca;
                    if (PicGrdSca == 0 )
                        $("#WipTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor5 = item.PicScrSca - item.PicGrdSca;
                        if (newcolor5 >= 0 && item.PicTgtSca > 0)
                            $("#WipTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#WipTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrSca;
                    PicTotGrade = PicTotGrade + item.PicGrdSca;
                    //---- consumables
                    $("#CasGrdCon").text(formatNumber(item.PicGrdInv));
                    $("#CasTgtCon").text(formatNumber(item.PicTgtInv));
                    $("#CasActCon").text(formatNumber(item.PicActInv));
                    $("#CasAchCon").text(formatNumber(item.PicAchInv.toFixed(2)));
                    $("#CasScrCon").text(formatNumber(item.PicScrInv.toFixed(2)));
                    var PicGrdInv = item.PicGrdInv;
                    var PicTgtInv = item.PicTgtInv;
                    if (PicGrdInv == 0 )
                        $("#ConTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor6 = item.PicScrInv - item.PicGrdInv;
                        if (newcolor6 >= 0 && item.PicTgtInv > 0)
                            $("#ConTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#ConTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrInv;
                    PicTotGrade = PicTotGrade + item.PicGrdInv;
                    //---- FOH
                    $("#CasGrdFoh").text(formatNumber(item.PicGrdDpp));
                    $("#CasTgtFoh").text(formatNumber(item.PicTgtDpp));
                    $("#CasActFoh").text(formatNumber(item.PicActDpp));
                    $("#CasAchFoh").text(formatNumber(item.PicAchDpp.toFixed(2)));
                    $("#CasScrFoh").text(formatNumber(item.PicScrDpp.toFixed(2)));
                    var PicGrdDpp = item.PicGrdDpp;
                    var PicTgtDpp = item.PicTgtDpp;
                    if (PicGrdDpp == 0 )
                        $("#FohTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor7 = item.PicScrDpp - item.PicGrdDpp;
                        if (newcolor7 >= 0 && item.PicTgtDpp > 0)
                            $("#FohTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#FohTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrDpp;
                    PicTotGrade = PicTotGrade + item.PicGrdDpp;

                    //---- FOH Non
                    $("#CasGrdNon").text(formatNumber(item.PicGrdNon));
                    $("#CasTgtNon").text(formatNumber(item.PicTgtNon));
                    $("#CasActNon").text(formatNumber(item.PicActNon));
                    $("#CasAchNon").text(formatNumber(item.PicAchNon.toFixed(2)));
                    $("#CasScrNon").text(formatNumber(item.PicScrNon.toFixed(2)));
                    var PicGrdNon = item.PicGrdNon;
                    if (PicGrdNon == 0)
                        $("#NonTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorNon = item.PicScrNon - item.PicGrdNon;
                        if (newcolorNon >= 0 && item.PicTgtNon > 0)
                            $("#NonTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#NonTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrNon;
                    PicTotGrade = PicTotGrade + item.PicGrdNon;

                    //---- Bad Casting
                    $("#CasGrdBad").text(formatNumber(item.PicGrdBad));
                    $("#CasTgtBad").text(formatNumber(item.PicTgtBad));
                    $("#CasActBad").text(formatNumber(item.PicActBad));
                    $("#CasAchBad").text(formatNumber(item.PicAchBad.toFixed(2)));
                    $("#CasScrBad").text(formatNumber(item.PicScrBad.toFixed(2)));
                    var PicGrdBad = item.PicGrdBad;
                    if (PicGrdBad == 0)
                        $("#BadTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorBad = item.PicScrBad - item.PicGrdBad;
                        if (newcolorBad >= 0 && item.PicTgtBad > 0)
                            $("#BadTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#BadTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrBad;
                    PicTotGrade = PicTotGrade + item.PicGrdBad;

                    //---- Scrap
                    $("#CasGrdScp").text(formatNumber(item.PicGrdScp));
                    $("#CasTgtScp").text(formatNumber(item.PicTgtScp));
                    $("#CasActScp").text(formatNumber(item.PicActScp));
                    $("#CasAchScp").text(formatNumber(item.PicAchScp.toFixed(2)));
                    $("#CasScrScp").text(formatNumber(item.PicScrScp.toFixed(2)));
                    var PicGrdScp = item.PicGrdScp;
                    if (PicGrdScp == 0)
                        $("#ScpTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorScp = item.PicScrScp - item.PicGrdScp;
                        if (newcolorScp >= 0 && item.PicTgtScp > 0)
                            $("#ScpTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#ScpTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrScp;
                    PicTotGrade = PicTotGrade + item.PicGrdScp;

                    //---- Alloy
                    $("#CasGrdAly").text(formatNumber(item.PicGrdAly));
                    $("#CasTgtAly").text(formatNumber(item.PicTgtAly));
                    $("#CasActAly").text(formatNumber(item.PicActAly));
                    $("#CasAchAly").text(formatNumber(item.PicAchAly.toFixed(2)));
                    $("#CasScrAly").text(formatNumber(item.PicScrAly.toFixed(2)));
                    var PicGrdAly = item.PicGrdAly;
                    if (PicGrdAly == 0)
                        $("#AlyTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorAly = item.PicScrAly - item.PicGrdAly;
                        if (newcolorAly >= 0 && item.PicTgtAly > 0)
                            $("#AlyTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#AlyTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrAly;
                    PicTotGrade = PicTotGrade + item.PicGrdAly;

                    //---- Silica
                    $("#CasGrdSil").text(formatNumber(item.PicGrdSil));
                    $("#CasTgtSil").text(formatNumber(item.PicTgtSil));
                    $("#CasActSil").text(formatNumber(item.PicActSil));
                    $("#CasAchSil").text(formatNumber(item.PicAchSil.toFixed(2)));
                    $("#CasScrSil").text(formatNumber(item.PicScrSil.toFixed(2)));
                    var PicGrdSil = item.PicGrdSil;
                    if (PicGrdSil == 0)
                        $("#SilTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorSil = item.PicScrSil - item.PicGrdSil;
                        if (newcolorSil >= 0 && item.PicTgtSil > 0)
                            $("#SilTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#SilTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrSil;
                    PicTotGrade = PicTotGrade + item.PicGrdSil;

                    //---- Zircon Flour
                    $("#CasGrdZif").text(formatNumber(item.PicGrdZif));
                    $("#CasTgtZif").text(formatNumber(item.PicTgtZif));
                    $("#CasActZif").text(formatNumber(item.PicActZif));
                    $("#CasAchZif").text(formatNumber(item.PicAchZif.toFixed(2)));
                    $("#CasScrZif").text(formatNumber(item.PicScrZif.toFixed(2)));
                    var PicGrdZif = item.PicGrdZif;
                    if (PicGrdZif == 0)
                        $("#ZifTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorZif = item.PicScrZif - item.PicGrdZif;
                        if (newcolorZif >= 0 && item.PicTgtZif > 0)
                            $("#ZifTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#ZifTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrZif;
                    PicTotGrade = PicTotGrade + item.PicGrdZif;

                    //---- Zircon Sads
                    $("#CasGrdZis").text(formatNumber(item.PicGrdZis));
                    $("#CasTgtZis").text(formatNumber(item.PicTgtZis));
                    $("#CasActZis").text(formatNumber(item.PicActZis));
                    $("#CasAchZis").text(formatNumber(item.PicAchZis.toFixed(2)));
                    $("#CasScrZis").text(formatNumber(item.PicScrZis.toFixed(2)));
                    var PicGrdZis = item.PicGrdZis;
                    if (PicGrdZis == 0)
                        $("#ZisTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorZis = item.PicScrZis - item.PicGrdZis;
                        if (newcolorZis >= 0 && item.PicTgtZis > 0)
                            $("#ZisTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#ZisTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrZis;
                    PicTotGrade = PicTotGrade + item.PicGrdZis;

                    //---- Mullite Flour
                    $("#CasGrdMuf").text(formatNumber(item.PicGrdMuf));
                    $("#CasTgtMuf").text(formatNumber(item.PicTgtMuf));
                    $("#CasActMuf").text(formatNumber(item.PicActMuf));
                    $("#CasAchMuf").text(formatNumber(item.PicAchMuf.toFixed(2)));
                    $("#CasScrMuf").text(formatNumber(item.PicScrMuf.toFixed(2)));
                    var PicGrdMuf = item.PicGrdMuf;
                    if (PicGrdMuf == 0)
                        $("#MufTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorMuf = item.PicScrMuf - item.PicGrdMuf;
                        if (newcolorMuf >= 0 && item.PicTgtMuf > 0)
                            $("#MufTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#MufTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrMuf;
                    PicTotGrade = PicTotGrade + item.PicGrdMuf;

                    //---- Mullite Sands 30-80
                    $("#CasGrdMu3").text(formatNumber(item.PicGrdMu3));
                    $("#CasTgtMu3").text(formatNumber(item.PicTgtMu3));
                    $("#CasActMu3").text(formatNumber(item.PicActMu3));
                    $("#CasAchMu3").text(formatNumber(item.PicAchMu3.toFixed(2)));
                    $("#CasScrMu3").text(formatNumber(item.PicScrMu3.toFixed(2)));
                    var PicGrdMu3 = item.PicGrdMu3;
                    if (PicGrdMu3 == 0)
                        $("#Mu3Title").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorMu3 = item.PicScrMu3 - item.PicGrdMu3;
                        if (newcolorMu3 >= 0 && item.PicTgtMu3 > 0)
                            $("#Mu3Title").css({ "color": "black", "font-weight": "bold" });
                        else $("#Mu3Title").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrMu3;
                    PicTotGrade = PicTotGrade + item.PicGrdMu3;

                    //---- Mullite Sands 15-30
                    $("#CasGrdMu1").text(formatNumber(item.PicGrdMu1));
                    $("#CasTgtMu1").text(formatNumber(item.PicTgtMu1));
                    $("#CasActMu1").text(formatNumber(item.PicActMu1));
                    $("#CasAchMu1").text(formatNumber(item.PicAchMu1.toFixed(2)));
                    $("#CasScrMu1").text(formatNumber(item.PicScrMu1.toFixed(2)));
                    var PicGrdMu1 = item.PicGrdMu1;
                    if (PicGrdMu1 == 0)
                        $("#Mu1Title").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorMu1 = item.PicScrMu1 - item.PicGrdMu1;
                        if (newcolorMu1 >= 0 && item.PicTgtMu1 > 0)
                            $("#Mu1Title").css({ "color": "black", "font-weight": "bold" });
                        else $("#Mu1Title").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTot = PicScrTot + item.PicScrMu1;
                    PicTotGrade = PicTotGrade + item.PicGrdMu1;

                    /*----------- TOTAL  ------------*/
                    $("#PicGrdTot").text(formatNumber(PicTotGrade.toFixed(2)));
                    $("#PicScrTot").text(formatNumber(PicScrTot.toFixed(2)));


                });
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            },
            beforeSend: function () { $(".loader").show(); },
            complete: function () { $(".loader").hide(); },
            type: 'POST', dataType: 'json'
        });

    
    }

    function getMonthView(thn, bln) {       
        PicScrTotMonth = 0;
        PicScrTotSum = 0;
        PicTotGradeMonth = 0;
        PicTotGradeSum = 0;
        //ini belum
        var nmbulan = valMonth(bln);
        $('#blnnan').text('MONTH : ' + nmbulan + '-' + thn);

        var userAu = $('#authorid').val();
        var kpiObj = {
            id: thn,
            bln: bln,
            ch: "M"
        }
        $.ajax({
            url: urlKPI + "/vCastingDeptSummary/",
            data: JSON.stringify(kpiObj),
            contentType: "application/json;charset=utf-8",
            success: function (result) {
                $.each(result, function (key, item) {
                    if (userAu != "VST") {
                        $("#CasGrdRevMonth").text(formatNumber(item.PicGrdRev));
                        $("#CasTgtRevMonth").text(formatNumber(item.PicTgtRev));
                        $("#CasActRevMonth").text(formatNumber(item.PicActRev));
                        $("#CasAchRevMonth").text(formatNumber(item.PicAchRev.toFixed(2)));
                        $("#CasScrRevMonth").text(formatNumber(item.PicScrRev.toFixed(2)));
                        var PicGrdRev = item.PicGrdRev;
                        var PicTgtRev = item.PicTgtRev;
                        if (PicGrdRev == 0)
                            $("#RevTitleMonth").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor = item.PicScrRev - item.PicGrdRev;
                            if (newcolor >= 0 && item.PicTgtRev > 0)
                                $("#RevTitleMonth").css({ "color": "black", "font-weight": "bold" });
                            else $("#RevTitleMonth").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTotMonth = PicScrTotMonth + item.PicScrRev;
                        PicTotGradeMonth = PicTotGradeMonth + item.PicGrdRev;
                    }
                    if (thn < 2022) {
                        $('#trhdrratMonth').show();
                        $('#trhdrdrmMonth').show();
                        $('#trhdrmatMonth').show();
                        $('#trhdrredMonth').show();
                        $('#trhdrsafMonth').show();
                        /*------------reject rate at cust---------*/
                        $("#CasGrdRatMonth").text(formatNumber(item.PicGrdRjt));
                        $("#CasTgtRatMonth").text(formatNumber(item.PicTgtRjt));
                        $("#CasActRatMonth").text(formatNumber(item.PicActRjt));
                        $("#CasAchRatMonth").text(formatNumber(item.PicAchRjt.toFixed(2)));
                        $("#CasScrRatMonth").text(formatNumber(item.PicScrRjt.toFixed(2)));
                        var PicGrdRjt = item.PicGrdRjt;
                        var PicTgtRjt = item.PicTgtRjt;
                        if (PicGrdRjt == 0)
                            $("#RatTitleMonth").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor11 = item.PicScrRjt - item.PicGrdRjt;
                            if (newcolor11 >= 0 && item.PicTgtRjt > 0)
                                $("#RatTitleMonth").css({ "color": "black", "font-weight": "bold" });
                            else $("#RatTitleMonth").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTotMonth = PicScrTotMonth + item.PicScrRjt;
                        PicTotGradeMonth = PicTotGradeMonth + item.PicGrdRjt;

                        /*------------Drm---------*/
                        $("#CasGrdDrmMonth").text(formatNumber(item.PicGrdAir));
                        $("#CasTgtDrmMonth").text(formatNumber(item.PicTgtAir));
                        $("#CasActDrmMonth").text(formatNumber(item.PicActAir));
                        $("#CasAchDrmMonth").text(formatNumber(item.PicAchAir.toFixed(2)));
                        $("#CasScrDrmMonth").text(formatNumber(item.PicScrAir.toFixed(2)));
                        var PicGrdAir = item.PicGrdAir;
                        var PicTgtAir = item.PicTgtAir;
                        if (PicGrdAir == 0)
                            $("#DrmTitleMonth").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor3 = item.PicScrAir - item.PicGrdAir;
                            if (newcolor3 >= 0 && item.PicTgtAir > 0)
                                $("#DrmTitleMonth").css({ "color": "black", "font-weight": "bold" });
                            else $("#DrmTitleMonth").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTotMonth = PicScrTotMonth + item.PicScrAir;
                        PicTotGradeMonth = PicTotGradeMonth + item.PicGrdAir;

                        /*------------prod.cost control material---------*/
                        $("#CasGrdMatMonth").text(formatNumber(item.PicGrdMus));
                        $("#CasTgtMatMonth").text(formatNumber(item.PicTgtMus));
                        $("#CasActMatMonth").text(formatNumber(item.PicActMus));
                        $("#CasAchMatMonth").text(formatNumber(item.PicAchMus.toFixed(2)));
                        $("#CasScrMatMonth").text(formatNumber(item.PicScrMus.toFixed(2)));
                        var PicGrdMus = item.PicGrdMus;
                        var PicTgtMus = item.PicTgtMus;
                        if (PicGrdMus == 0)
                            $("#MatTitleMonth").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor10 = item.PicScrMus - item.PicGrdMus;
                            if (newcolor10 >= 0 && item.PicTgtMus > 0)
                                $("#MatTitleMonth").css({ "color": "black", "font-weight": "bold" });
                            else $("#MatTitleMonth").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTotMonth = PicScrTotMonth + item.PicScrMus;
                        PicTotGradeMonth = PicTotGradeMonth + item.PicGrdMus;

                        //----REDUCTION
                        $("#CasGrdRedMonth").text(formatNumber(item.PicGrdEme));
                        $("#CasTgtRedMonth").text(formatNumber(item.PicTgtEme));
                        $("#CasActRedMonth").text(formatNumber(item.PicActEme));
                        $("#CasAchRedMonth").text(formatNumber(item.PicAchEme.toFixed(2)));
                        $("#CasScrRedMonth").text(formatNumber(item.PicScrEme.toFixed(2)));
                        var PicGrdEme = item.PicGrdEme;
                        var PicTgtEme = item.PicTgtEme;
                        if (PicGrdEme == 0)
                            $("#RedTitleMonth").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor8 = item.PicScrEme - item.PicGrdEme;
                            if (newcolor8 >= 0 && item.PicTgtEme > 0)
                                $("#RedTitleMonth").css({ "color": "black", "font-weight": "bold" });
                            else $("#RedTitleMonth").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTotMonth = PicScrTotMonth + item.PicScrEme;
                        PicTotGradeMonth = PicTotGradeMonth + item.PicGrdEme;
                        //----Safety Index
                        $("#CasGrdSafMonth").text(formatNumber(item.PicGrdSaf));
                        $("#CasTgtSafMonth").text(formatNumber(item.PicTgtSaf));
                        TempGradeSafMonth = item.PicGrdSaf;
                        TempTargetSafMonth = item.PicTgtSaf;
                        PicTotGradeMonth = PicTotGradeMonth + item.PicGrdSaf;

                        $("#PicScrTotMonth").text(formatNumber(PicScrTotMonth.toFixed(2)));
                        $("#PicGrdTotMonth").text(formatNumber(PicTotGradeMonth.toFixed(2)));

                        var kpiHRD = {
                            id: thn,
                            bln: bln,
                            ch: "M"
                        }
                        $.ajax({
                            url: urlKPI + "/CastingDept/",
                            data: JSON.stringify(kpiHRD),
                            contentType: "application/json;charset=utf-8",
                            success: function (result) {
                                $.each(result, function (key, item) {
                                    /*-- safety index -----------*/
                                    var MacActSaf = item.ibpActSafe;
                                    $("#CasActSafMonth").text(formatNumber(MacActSaf.toFixed(2)));
                                    $("#CasAchSafMonth").text(formatNumber(item.PicAchSaf.toFixed(2)));
                                    $("#CasScrSafMonth").text(formatNumber(item.PicScrSaf.toFixed(2)));
                                    console.log(MacActSaf);
                                    if (TempGradeSafMonth == 0)
                                        $("#SafTitleMonth").css({ "color": "black", "font-weight": "normal" });
                                    else {
                                        if (MacActSaf == 0)
                                            $("#SafTitleMonth").css({ "color": "black", "font-weight": "bold" });
                                        else $("#SafTitleMonth").css({ "color": "red", "font-weight": "bold" });
                                    }


                                    PicScrTotMonth = PicScrTotMonth + item.PicScrSaf;


                                });
                            },
                            error: function (errormessage) {
                                alert(errormessage.responseText);
                            },
                            beforeSend: function () { $(".loader").show(); },
                            complete: function () { $(".loader").hide(); },
                            type: 'POST', dataType: 'json'
                        });

                    } else {
                        $('#trhdrratMonth').hide();
                        $('#trhdrdrmMonth').hide();
                        $('#trhdrmatMonth').hide();
                        $('#trhdrredMonth').hide();
                        $('#trhdrsafMonth').hide();

                    }

                    /*------------output pouring---------*/
                    if (thn < 2020) {
                        $("#trdtl").show();
                        $("#CasGrdOutMonth").text(formatNumber(item.PicGrdTvb));
                        $("#CasTgtOutMonth").text(formatNumber(item.PicTgtTvb));
                        $("#CasActOutMonth").text(formatNumber(item.PicActTvb));
                        $("#CasAchOutMonth").text(formatNumber(item.PicAchTvb.toFixed(2)));
                        $("#CasScrOutMonth").text(formatNumber(item.PicScrTvb.toFixed(2)));
                        var PicGrdTvb = item.PicGrdTvb;
                        var PicTgtTvb = item.PicTgtTvb;
                        console.log(PicTgtTvb);
                        if (PicGrdTvb == 0)
                            $("#OutTitleMonth").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor10 = item.PicScrTvb - item.PicGrdTvb;
                            if (newcolor10 >= 0 && item.PicTgtTvb > 0)
                                $("#OutTitleMonth").css({ "color": "black", "font-weight": "bold" });
                            else $("#OutTitleMonth").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTotMonth = PicScrTotMonth + item.PicScrTvb;
                        PicTotGradeMonth = PicTotGradeMonth + item.PicGrdTvb;
                    }
                    else {
                        $("#trdtl").hide();
                    }
                    /*------------pda---------*/
                    $("#CasGrdPdaMonth").text(formatNumber(item.PicGrdPda));
                    $("#CasTgtPdaMonth").text(formatNumber(item.PicTgtPda));
                    $("#CasActPdaMonth").text(formatNumber(item.PicActPda));
                    $("#CasAchPdaMonth").text(formatNumber(item.PicAchPda.toFixed(2)));
                    $("#CasScrPdaMonth").text(formatNumber(item.PicScrPda.toFixed(2)));
                    var PicGrdPda = item.PicGrdPda;
                    var PicTgtPda = item.PicTgtPda;
                    if (PicGrdPda == 0 )
                        $("#PdaTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor1 = item.PicScrPda - item.PicGrdPda;
                        if (newcolor1 >= 0 && item.PicTgtPda > 0)
                            $("#PdaTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#PdaTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrPda;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdPda;
                    /*------------labor cost ---------*/
                    $("#CasGrdLabMonth").text(formatNumber(item.PicGrdPdc));
                    $("#CasTgtLabMonth").text(formatNumber(item.PicTgtPdc));
                    $("#CasActLabMonth").text(formatNumber(item.PicActPdc.toFixed(2)));
                    $("#CasAchLabMonth").text(formatNumber(item.PicAchPdc.toFixed(2)));
                    $("#CasScrLabMonth").text(formatNumber(item.PicScrPdc.toFixed(2)));
                    var PicGrdPdc = item.PicGrdPdc;
                    var PicTgtPdc = item.PicTgtPdc;
                    if (PicGrdPdc == 0 )
                        $("#LabTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorLab1 = item.PicScrPdc - item.PicGrdPdc;
                        if (newcolorLab1 >= 0)
                            $("#LabTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#LabTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrPdc;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdPdc;
                    //---- reject rate casting
                    $("#CasGrdRejMonth").text(formatNumber(item.PicGrdOth));
                    $("#CasTgtRejMonth").text(formatNumber(item.PicTgtOth));
                    $("#CasActRejMonth").text(formatNumber(item.PicActOth));
                    if (item.PicAchOth < 0)
                        $("#CasAchRejMonth").text(formatNumber(0));
                    else 
                        $("#CasAchRejMonth").text(formatNumber(item.PicAchOth.toFixed(2)));
                    $("#CasScrRejMonth").text(formatNumber(item.PicScrOth.toFixed(2)));
                    var PicGrdOth = item.PicGrdOth;
                    var PicTgtOth = item.PicTgtOth;
                    if (PicGrdOth == 0 )
                        $("#RejTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor4 = item.PicScrOth - item.PicGrdOth;
                        if (newcolor4 >= 0 && item.PicTgtOth > 0)
                            $("#RejTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#RejTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrOth;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdOth;
                    //---- wip
                    $("#CasGrdWipMonth").text(formatNumber(item.PicGrdSca));
                    $("#CasTgtWipMonth").text(formatNumber(item.PicTgtSca));
                    $("#CasActWipMonth").text(formatNumber(item.PicActSca));
                    $("#CasAchWipMonth").text(formatNumber(item.PicAchSca.toFixed(2)));
                    $("#CasScrWipMonth").text(formatNumber(item.PicScrSca.toFixed(2)));
                    var PicGrdSca = item.PicGrdSca;
                    var PicTgtSca = item.PicTgtSca;
                    if (PicGrdSca == 0 )
                        $("#WipTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor5 = item.PicScrSca - item.PicGrdSca;
                        if (newcolor5 >= 0 && item.PicTgtSca > 0)
                            $("#WipTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#WipTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrSca;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdSca;
                    //---- consumables
                    $("#CasGrdConMonth").text(formatNumber(item.PicGrdInv));
                    $("#CasTgtConMonth").text(formatNumber(item.PicTgtInv));
                    $("#CasActConMonth").text(formatNumber(item.PicActInv));
                    $("#CasAchConMonth").text(formatNumber(item.PicAchInv.toFixed(2)));
                    $("#CasScrConMonth").text(formatNumber(item.PicScrInv.toFixed(2)));
                    var PicGrdInv = item.PicGrdInv;
                    var PicTgtInv = item.PicTgtInv;
                    if (PicGrdInv == 0 )
                        $("#ConTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor6 = item.PicScrInv - item.PicGrdInv;
                        if (newcolor6 >= 0 && item.PicTgtInv > 0)
                            $("#ConTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#ConTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrInv;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdInv;
                    //---- FOH
                    $("#CasGrdFohMonth").text(formatNumber(item.PicGrdDpp));
                    $("#CasTgtFohMonth").text(formatNumber(item.PicTgtDpp));
                    $("#CasActFohMonth").text(formatNumber(item.PicActDpp));
                    $("#CasAchFohMonth").text(formatNumber(item.PicAchDpp.toFixed(2)));
                    $("#CasScrFohMonth").text(formatNumber(item.PicScrDpp.toFixed(2)));
                    var PicGrdDpp = item.PicGrdDpp;
                    var PicTgtDpp = item.PicTgtDpp;
                    if (PicGrdDpp == 0 )
                        $("#FohTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor7 = item.PicScrDpp - item.PicGrdDpp;
                        if (newcolor7 >= 0 && item.PicTgtDpp > 0)
                            $("#FohTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#FohTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrDpp;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdDpp;

                    //---- FOH Non
                    $("#CasGrdNonMonth").text(formatNumber(item.PicGrdNon));
                    $("#CasTgtNonMonth").text(formatNumber(item.PicTgtNon));
                    $("#CasActNonMonth").text(formatNumber(item.PicActNon));
                    $("#CasAchNonMonth").text(formatNumber(item.PicAchNon.toFixed(2)));
                    $("#CasScrNonMonth").text(formatNumber(item.PicScrNon.toFixed(2)));
                    var PicGrdNon = item.PicGrdNon;
                    if (PicGrdNon == 0)
                        $("#NonTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorNon = item.PicScrNon - item.PicGrdNon;
                        if (newcolorNon >= 0 && item.PicTgtNon > 0)
                            $("#NonTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#NonTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrNon;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdNon;

                    //---- Bad Casting
                    $("#CasGrdBadMonth").text(formatNumber(item.PicGrdBad));
                    $("#CasTgtBadMonth").text(formatNumber(item.PicTgtBad));
                    $("#CasActBadMonth").text(formatNumber(item.PicActBad));
                    $("#CasAchBadMonth").text(formatNumber(item.PicAchBad.toFixed(2)));
                    $("#CasScrBadMonth").text(formatNumber(item.PicScrBad.toFixed(2)));
                    var PicGrdBad = item.PicGrdBad;
                    if (PicGrdBad == 0)
                        $("#BadTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorBad = item.PicScrBad - item.PicGrdBad;
                        if (newcolorBad >= 0 && item.PicTgtBad > 0)
                            $("#BadTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#BadTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrBad;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdBad;

                    //---- Scrap
                    $("#CasGrdScpMonth").text(formatNumber(item.PicGrdScp));
                    $("#CasTgtScpMonth").text(formatNumber(item.PicTgtScp));
                    $("#CasActScpMonth").text(formatNumber(item.PicActScp));
                    $("#CasAchScpMonth").text(formatNumber(item.PicAchScp.toFixed(2)));
                    $("#CasScrScpMonth").text(formatNumber(item.PicScrScp.toFixed(2)));
                    var PicGrdScp = item.PicGrdScp;
                    if (PicGrdScp == 0)
                        $("#ScpTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorScp = item.PicScrScp - item.PicGrdScp;
                        if (newcolorScp >= 0 && item.PicTgtScp > 0)
                            $("#ScpTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#ScpTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrScp;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdScp;

                    //---- Alloy
                    $("#CasGrdAlyMonth").text(formatNumber(item.PicGrdAly));
                    $("#CasTgtAlyMonth").text(formatNumber(item.PicTgtAly));
                    $("#CasActAlyMonth").text(formatNumber(item.PicActAly));
                    $("#CasAchAlyMonth").text(formatNumber(item.PicAchAly.toFixed(2)));
                    $("#CasScrAlyMonth").text(formatNumber(item.PicScrAly.toFixed(2)));
                    var PicGrdAly = item.PicGrdAly;
                    if (PicGrdAly == 0)
                        $("#AlyTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorAly = item.PicScrAly - item.PicGrdAly;
                        if (newcolorAly >= 0 && item.PicTgtAly > 0)
                            $("#AlyTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#AlyTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrAly;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdAly;

                    //---- Silica
                    $("#CasGrdSilMonth").text(formatNumber(item.PicGrdSil));
                    $("#CasTgtSilMonth").text(formatNumber(item.PicTgtSil));
                    $("#CasActSilMonth").text(formatNumber(item.PicActSil));
                    $("#CasAchSilMonth").text(formatNumber(item.PicAchSil.toFixed(2)));
                    $("#CasScrSilMonth").text(formatNumber(item.PicScrSil.toFixed(2)));
                    var PicGrdSil = item.PicGrdSil;
                    if (PicGrdSil == 0)
                        $("#SilTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorSil = item.PicScrSil - item.PicGrdSil;
                        if (newcolorSil >= 0 && item.PicTgtSil > 0)
                            $("#SilTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#SilTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrSil;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdSil;

                    //---- Zircon Flour
                    $("#CasGrdZifMonth").text(formatNumber(item.PicGrdZif));
                    $("#CasTgtZifMonth").text(formatNumber(item.PicTgtZif));
                    $("#CasActZifMonth").text(formatNumber(item.PicActZif));
                    $("#CasAchZifMonth").text(formatNumber(item.PicAchZif.toFixed(2)));
                    $("#CasScrZifMonth").text(formatNumber(item.PicScrZif.toFixed(2)));
                    var PicGrdZif = item.PicGrdZif;
                    if (PicGrdZif == 0)
                        $("#ZifTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorZif = item.PicScrZif - item.PicGrdZif;
                        if (newcolorZif >= 0 && item.PicTgtZif > 0)
                            $("#ZifTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#ZifTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrZif;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdZif;

                    //---- Zircon Sands
                    $("#CasGrdZisMonth").text(formatNumber(item.PicGrdZis));
                    $("#CasTgtZisMonth").text(formatNumber(item.PicTgtZis));
                    $("#CasActZisMonth").text(formatNumber(item.PicActZis));
                    $("#CasAchZisMonth").text(formatNumber(item.PicAchZis.toFixed(2)));
                    $("#CasScrZisMonth").text(formatNumber(item.PicScrZis.toFixed(2)));
                    var PicGrdZis = item.PicGrdZis;
                    if (PicGrdZis == 0)
                        $("#ZisTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorZis = item.PicScrZis - item.PicGrdZis;
                        if (newcolorZis >= 0 && item.PicTgtZis > 0)
                            $("#ZisTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#ZisTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrZis;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdZis;

                    //---- Mullite Flour
                    $("#CasGrdMufMonth").text(formatNumber(item.PicGrdMuf));
                    $("#CasTgtMufMonth").text(formatNumber(item.PicTgtMuf));
                    $("#CasActMufMonth").text(formatNumber(item.PicActMuf));
                    $("#CasAchMufMonth").text(formatNumber(item.PicAchMuf.toFixed(2)));
                    $("#CasScrMufMonth").text(formatNumber(item.PicScrMuf.toFixed(2)));
                    var PicGrdMuf = item.PicGrdMuf;
                    if (PicGrdMuf == 0)
                        $("#MufTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorMuf = item.PicScrMuf - item.PicGrdMuf;
                        if (newcolorMuf >= 0 && item.PicTgtMuf > 0)
                            $("#MufTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#MufTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrMuf;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdMuf;

                    //---- Mullite Sands 30-80
                    $("#CasGrdMu3Month").text(formatNumber(item.PicGrdMu3));
                    $("#CasTgtMu3Month").text(formatNumber(item.PicTgtMu3));
                    $("#CasActMu3Month").text(formatNumber(item.PicActMu3));
                    $("#CasAchMu3Month").text(formatNumber(item.PicAchMu3.toFixed(2)));
                    $("#CasScrMu3Month").text(formatNumber(item.PicScrMu3.toFixed(2)));
                    var PicGrdMu3 = item.PicGrdMu3;
                    if (PicGrdMu3 == 0)
                        $("#Mu3TitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorMu3 = item.PicScrMu3 - item.PicGrdMu3;
                        if (newcolorMu3 >= 0 && item.PicTgtMu3 > 0)
                            $("#Mu3TitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#Mu3TitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrMu3;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdMu3;

                    //---- Mullite Sands 15-30
                    $("#CasGrdMu1Month").text(formatNumber(item.PicGrdMu1));
                    $("#CasTgtMu1Month").text(formatNumber(item.PicTgtMu1));
                    $("#CasActMu1Month").text(formatNumber(item.PicActMu1));
                    $("#CasAchMu1Month").text(formatNumber(item.PicAchMu1.toFixed(2)));
                    $("#CasScrMu1Month").text(formatNumber(item.PicScrMu1.toFixed(2)));
                    var PicGrdMu1 = item.PicGrdMu1;
                    if (PicGrdMu1 == 0)
                        $("#Mu1TitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorMu1 = item.PicScrMu1 - item.PicGrdMu1;
                        if (newcolorMu1 >= 0 && item.PicTgtMu1 > 0)
                            $("#Mu1TitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#Mu1TitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotMonth = PicScrTotMonth + item.PicScrMu1;
                    PicTotGradeMonth = PicTotGradeMonth + item.PicGrdMu1;


                    /*---------------Grand Total---------------------*/
                    $("#PicScrTotMonth").text(formatNumber(PicScrTotMonth.toFixed(2)));
                    $("#PicGrdTotMonth").text(formatNumber(PicTotGradeMonth.toFixed(2)));

                });
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            },
            beforeSend: function () { $(".loader").show(); },
            complete: function () { $(".loader").hide(); },
            type: 'POST', dataType: 'json'
        });


        /*--------------- YEARLY ---------------*/

        var kpiObj = {
            id: thn,
            bln: bln,
            ch: "Y"
        }
        $.ajax({
            url: urlKPI + "/vCastingDeptSummary/",
            data: JSON.stringify(kpiObj),
            contentType: "application/json;charset=utf-8",
            success: function (result) {
                $.each(result, function (key, item) {
                    if (userAu != "VST") {
                        $("#CasGrdRevSum").text(formatNumber(item.PicGrdRev));
                        $("#CasTgtRevSum").text(formatNumber(item.PicTgtRev));
                        $("#CasActRevSum").text(formatNumber(item.PicActRev));
                        $("#CasAchRevSum").text(formatNumber(item.PicAchRev.toFixed(2)));
                        $("#CasScrRevSum").text(formatNumber(item.PicScrRev.toFixed(2)));
                        var PicGrdRev = item.PicGrdRev;
                        var PicTgtRev = item.PicTgtRev;
                        if (PicGrdRev == 0)
                            $("#RevTitleSum").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor = item.PicScrRev - item.PicGrdRev;
                            if (newcolor >= 0 && item.PicTgtRev > 0)
                                $("#RevTitleSum").css({ "color": "black", "font-weight": "bold" });
                            else $("#RevTitleSum").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTotSum = PicScrTotSum + item.PicScrRev;
                        PicTotGradeSum = PicTotGradeSum + item.PicGrdRev;
                    }

                    if (thn < 2022) {
                        $('#trhdrratSum').show();
                        $('#trhdrdrmSum').show();
                        $('#trhdrmatSum').show();
                        $('#trhdrredSum').show();
                        $('#trhdrsafSum').show();

                        /*------------reject rate at cust---------*/
                        $("#CasGrdRatSum").text(formatNumber(item.PicGrdRjt));
                        $("#CasTgtRatSum").text(formatNumber(item.PicTgtRjt));
                        $("#CasActRatSum").text(formatNumber(item.PicActRjt));
                        $("#CasAchRatSum").text(formatNumber(item.PicAchRjt.toFixed(2)));
                        $("#CasScrRatSum").text(formatNumber(item.PicScrRjt.toFixed(2)));
                        var PicGrdRjt = item.PicGrdRjt;
                        var PicTgtRjt = item.PicTgtRjt;
                        if (PicGrdRjt == 0)
                            $("#RatTitleSum").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor11 = item.PicScrRjt - item.PicGrdRjt;
                            if (newcolor11 >= 0 && item.PicTgtRjt > 0)
                                $("#RatTitleSum").css({ "color": "black", "font-weight": "bold" });
                            else $("#RatTitleSum").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTotSum = PicScrTotSum + item.PicScrRjt;
                        PicTotGradeSum = PicTotGradeSum + item.PicGrdRjt;

                        /*------------Drm---------*/
                        $("#CasGrdDrmSum").text(formatNumber(item.PicGrdAir));
                        $("#CasTgtDrmSum").text(formatNumber(item.PicTgtAir));
                        $("#CasActDrmSum").text(formatNumber(item.PicActAir));
                        $("#CasAchDrmSum").text(formatNumber(item.PicAchAir.toFixed(2)));
                        $("#CasScrDrmSum").text(formatNumber(item.PicScrAir.toFixed(2)));
                        var PicGrdAir = item.PicGrdAir;
                        var PicTgtAir = item.PicTgtAir;
                        if (PicGrdAir == 0)
                            $("#DrmTitleSum").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor3 = item.PicScrAir - item.PicGrdAir;
                            if (newcolor3 >= 0 && item.PicTgtAir > 0)
                                $("#DrmTitleSum").css({ "color": "black", "font-weight": "bold" });
                            else $("#DrmTitleSum").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTotSum = PicScrTotSum + item.PicScrAir;
                        PicTotGradeSum = PicTotGradeSum + item.PicGrdAir;

                        /*------------prod.cost control material---------*/
                        $("#CasGrdMatSum").text(formatNumber(item.PicGrdMus));
                        $("#CasTgtMatSum").text(formatNumber(item.PicTgtMus));
                        $("#CasActMatSum").text(formatNumber(item.PicActMus));
                        $("#CasAchMatSum").text(formatNumber(item.PicAchMus.toFixed(2)));
                        $("#CasScrMatSum").text(formatNumber(item.PicScrMus.toFixed(2)));
                        var PicGrdMus = item.PicGrdMus;
                        var PicTgtMus = item.PicTgtMus;
                        if (PicGrdMus == 0)
                            $("#MatTitleSum").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor10 = item.PicScrMus - item.PicGrdMus;
                            if (newcolor10 >= 0 && item.PicTgtMus > 0)
                                $("#MatTitleSum").css({ "color": "black", "font-weight": "bold" });
                            else $("#MatTitleSum").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTotSum = PicScrTotSum + item.PicScrMus;
                        PicTotGradeSum = PicTotGradeSum + item.PicGrdMus;

                        //----REDUCTION
                        $("#CasGrdRedSum").text(formatNumber(item.PicGrdEme));
                        $("#CasTgtRedSum").text(formatNumber(item.PicTgtEme));
                        $("#CasActRedSum").text(formatNumber(item.PicActEme));
                        $("#CasAchRedSum").text(formatNumber(item.PicAchEme.toFixed(2)));
                        $("#CasScrRedSum").text(formatNumber(item.PicScrEme.toFixed(2)));
                        var PicGrdEme = item.PicGrdEme;
                        var PicTgtEme = item.PicTgtEme;
                        if (PicGrdDpp == 0)
                            $("#RedTitleSum").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor8 = item.PicScrEme - item.PicGrdEme;
                            if (newcolor8 >= 0 && item.PicTgtEme > 0)
                                $("#RedTitleSum").css({ "color": "black", "font-weight": "bold" });
                            else $("#RedTitleSum").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTotSum = PicScrTotSum + item.PicScrEme;
                        PicTotGradeSum = PicTotGradeSum + item.PicGrdEme;
                        //----Safety Index
                        $("#CasGrdSafSum").text(formatNumber(item.PicGrdSaf));
                        $("#CasTgtSafSum").text(formatNumber(item.PicTgtSaf));
                        TempGradeSafSum = item.PicGrdSaf;
                        TempTargetSafSum = item.PicTgtSaf;
                        PicTotGradeSum = PicTotGradeSum + item.PicGrdSaf;

                        $("#PicScrTotSum").text(formatNumber(PicScrTotSum.toFixed(2)));
                        $("#PicGrdTotSum").text(formatNumber(PicTotGradeSum.toFixed(2)));

                        var kpiHRD = {
                            id: thn,
                            bln: bln,
                            ch: "Y"
                        }
                        $.ajax({
                            url: urlKPI + "/CastingDept/",
                            data: JSON.stringify(kpiHRD),
                            contentType: "application/json;charset=utf-8",
                            success: function (result) {
                                $.each(result, function (key, item) {
                                    /*-- safety index -----------*/
                                    var MacActSaf = item.ibpActSafe;
                                    $("#CasActSafSum").text(formatNumber(MacActSaf.toFixed(2)));
                                    $("#CasAchSafSum").text(formatNumber(item.PicAchSaf.toFixed(2)));
                                    $("#CasScrSafSum").text(formatNumber(item.PicScrSaf.toFixed(2)));
                                    console.log(MacActSaf);
                                    if (TempGradeSafSum == 0)
                                        $("#SafTitleSum").css({ "color": "black", "font-weight": "normal" });
                                    else {
                                        if (MacActSaf == 0)
                                            $("#SafTitleSum").css({ "color": "black", "font-weight": "bold" });
                                        else $("#SafTitleSum").css({ "color": "red", "font-weight": "bold" });
                                    }
                                    PicScrTotSum = PicScrTotSum + item.PicScrSaf;

                                   


                                });
                            },
                            error: function (errormessage) {
                                alert(errormessage.responseText);
                            },
                            beforeSend: function () { $(".loader").show(); },
                            complete: function () { $(".loader").hide(); },
                            type: 'POST', dataType: 'json'
                        });



                    } else {
                        $('#trhdrratSum').hide();
                        $('#trhdrdrmSum').hide();
                        $('#trhdrmatSum').hide();
                        $('#trhdrredSum').hide();
                        $('#trhdrsafSum').hide();
                    }

                  
                    /*------------output pouring---------*/
                    if (thn < 2020) {
                        $("#trsubdtl").show();
                        $("#CasGrdOutSum").text(formatNumber(item.PicGrdTvb));
                        $("#CasTgtOutSum").text(formatNumber(item.PicTgtTvb));
                        $("#CasActOutSum").text(formatNumber(item.PicActTvb));
                        $("#CasAchOutSum").text(formatNumber(item.PicAchTvb.toFixed(2)));
                        $("#CasScrOutSum").text(formatNumber(item.PicScrTvb.toFixed(2)));
                        var PicGrdTvb = item.PicGrdTvb;
                        var PicTgtTvb = item.PicTgtTvb;
                        console.log(PicTgtTvb);
                        if (PicGrdTvb == 0)
                            $("#OutTitleSum").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor10 = item.PicScrTvb - item.PicGrdTvb;
                            if (newcolor10 >= 0 && item.PicTgtTvb > 0)
                                $("#OutTitleSum").css({ "color": "black", "font-weight": "bold" });
                            else $("#OutTitleSum").css({ "color": "red", "font-weight": "bold" });
                        }
                        PicScrTotSum = PicScrTotSum + item.PicScrTvb;
                        PicTotGradeSum = PicTotGradeSum + item.PicGrdTvb;
                    } else {
                        $("#trsubdtl").hide();
                    }
                    /*------------pda---------*/
                    $("#CasGrdPdaSum").text(formatNumber(item.PicGrdPda));
                    $("#CasTgtPdaSum").text(formatNumber(item.PicTgtPda));
                    $("#CasActPdaSum").text(formatNumber(item.PicActPda));
                    $("#CasAchPdaSum").text(formatNumber(item.PicAchPda.toFixed(2)));
                    $("#CasScrPdaSum").text(formatNumber(item.PicScrPda.toFixed(2)));
                    var PicGrdPda = item.PicGrdPda;
                    var PicTgtPda = item.PicTgtPda;
                    if (PicGrdPda == 0 )
                        $("#PdaTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor1 = item.PicScrPda - item.PicGrdPda;
                        if (newcolor1 >= 0 && item.PicTgtPda > 0)
                            $("#PdaTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#PdaTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrPda;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdPda;
                    /*------------labor cost ---------*/
                    $("#CasGrdLabSum").text(formatNumber(item.PicGrdPdc));
                    $("#CasTgtLabSum").text(formatNumber(item.PicTgtPdc));
                    $("#CasActLabSum").text(formatNumber(item.PicActPdc.toFixed(2)));
                    $("#CasAchLabSum").text(formatNumber(item.PicAchPdc.toFixed(2)));
                    $("#CasScrLabSum").text(formatNumber(item.PicScrPdc.toFixed(2)));
                    var PicGrdPdc = item.PicGrdPdc;
                    var PicTgtPdc = item.PicTgtPdc;
                    if (PicGrdPdc == 0 )
                        $("#LabTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorLab2 = item.PicScrPdc - item.PicGrdPdc;
                        if (newcolorLab2 >= 0)
                            $("#LabTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#LabTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrPdc;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdPdc;
                    //---- reject rate casting
                    $("#CasGrdRejSum").text(formatNumber(item.PicGrdOth));
                    $("#CasTgtRejSum").text(formatNumber(item.PicTgtOth));
                    $("#CasActRejSum").text(formatNumber(item.PicActOth));
                    $("#CasAchRejSum").text(formatNumber(item.PicAchOth.toFixed(2)));
                    $("#CasScrRejSum").text(formatNumber(item.PicScrOth.toFixed(2)));
                    var PicGrdOth = item.PicGrdOth;
                    var PicTgtOth = item.PicTgtOth;
                    if (PicGrdOth == 0 )
                        $("#RejTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor4 = item.PicScrOth - item.PicGrdOth;
                        if (newcolor4 >= 0 && item.PicTgtOth > 0)
                            $("#RejTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#RejTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrOth;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdOth;
                    //---- wip
                    $("#CasGrdWipSum").text(formatNumber(item.PicGrdSca));
                    $("#CasTgtWipSum").text(formatNumber(item.PicTgtSca));
                    $("#CasActWipSum").text(formatNumber(item.PicActSca));
                    $("#CasAchWipSum").text(formatNumber(item.PicAchSca.toFixed(2)));
                    $("#CasScrWipSum").text(formatNumber(item.PicScrSca.toFixed(2)));
                    var PicGrdSca = item.PicGrdSca;
                    var PicTgtSca = item.PicTgtSca;
                    if (PicGrdSca == 0 )
                        $("#WipTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor5 = item.PicScrSca - item.PicGrdSca;
                        if (newcolor5 >= 0 && item.PicTgtSca > 0)
                            $("#WipTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#WipTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrSca;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdSca;
                    //---- consumables
                    $("#CasGrdConSum").text(formatNumber(item.PicGrdInv));
                    $("#CasTgtConSum").text(formatNumber(item.PicTgtInv));
                    $("#CasActConSum").text(formatNumber(item.PicActInv));
                    $("#CasAchConSum").text(formatNumber(item.PicAchInv.toFixed(2)));
                    $("#CasScrConSum").text(formatNumber(item.PicScrInv.toFixed(2)));
                    var PicGrdInv = item.PicGrdInv;
                    var PicTgtInv = item.PicTgtInv;
                    if (PicGrdInv == 0 )
                        $("#ConTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor6 = item.PicScrInv - item.PicGrdInv;
                        if (newcolor6 >= 0 && item.PicTgtInv > 0)
                            $("#ConTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#ConTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrInv;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdInv;
                    //---- FOH
                    $("#CasGrdFohSum").text(formatNumber(item.PicGrdDpp));
                    $("#CasTgtFohSum").text(formatNumber(item.PicTgtDpp));
                    $("#CasActFohSum").text(formatNumber(item.PicActDpp));
                    $("#CasAchFohSum").text(formatNumber(item.PicAchDpp.toFixed(2)));
                    $("#CasScrFohSum").text(formatNumber(item.PicScrDpp.toFixed(2)));
                    var PicGrdDpp = item.PicGrdDpp;
                    var PicTgtDpp = item.PicTgtDpp;
                    if (PicGrdDpp == 0 )
                        $("#FohTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor7 = item.PicScrDpp - item.PicGrdDpp;
                        if (newcolor7 >= 0 && item.PicTgtDpp > 0)
                            $("#FohTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#FohTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrDpp;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdDpp;

                    //---- FOH Non
                    $("#CasGrdNonSum").text(formatNumber(item.PicGrdNon));
                    $("#CasTgtNonSum").text(formatNumber(item.PicTgtNon));
                    $("#CasActNonSum").text(formatNumber(item.PicActNon));
                    $("#CasAchNonSum").text(formatNumber(item.PicAchNon.toFixed(2)));
                    $("#CasScrNonSum").text(formatNumber(item.PicScrNon.toFixed(2)));
                    var PicGrdNon = item.PicGrdNon;
                    if (PicGrdNon == 0)
                        $("#NonTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorNon = item.PicScrNon - item.PicGrdNon;
                        if (newcolorNon >= 0 && item.PicTgtNon > 0)
                            $("#NonTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#NonTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrNon;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdNon;

                    //---- Bad Casting
                    $("#CasGrdBadSum").text(formatNumber(item.PicGrdBad));
                    $("#CasTgtBadSum").text(formatNumber(item.PicTgtBad));
                    $("#CasActBadSum").text(formatNumber(item.PicActBad));
                    $("#CasAchBadSum").text(formatNumber(item.PicAchBad.toFixed(2)));
                    $("#CasScrBadSum").text(formatNumber(item.PicScrBad.toFixed(2)));
                    var PicGrdBad = item.PicGrdBad;
                    if (PicGrdBad == 0)
                        $("#BadTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorBad = item.PicScrBad - item.PicGrdBad;
                        if (newcolorBad >= 0 && item.PicTgtBad > 0)
                            $("#BadTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#BadTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrBad;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdBad;

                    //---- Scrap
                    $("#CasGrdScpSum").text(formatNumber(item.PicGrdScp));
                    $("#CasTgtScpSum").text(formatNumber(item.PicTgtScp));
                    $("#CasActScpSum").text(formatNumber(item.PicActScp));
                    $("#CasAchScpSum").text(formatNumber(item.PicAchScp.toFixed(2)));
                    $("#CasScrScpSum").text(formatNumber(item.PicScrScp.toFixed(2)));
                    var PicGrdScp = item.PicGrdScp;
                    if (PicGrdScp == 0)
                        $("#ScpTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorScp = item.PicScrScp - item.PicGrdScp;
                        if (newcolorScp >= 0 && item.PicTgtScp > 0)
                            $("#ScpTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#ScpTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrScp;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdScp;

                    //---- Alloy
                    $("#CasGrdAlySum").text(formatNumber(item.PicGrdAly));
                    $("#CasTgtAlySum").text(formatNumber(item.PicTgtAly));
                    $("#CasActAlySum").text(formatNumber(item.PicActAly));
                    $("#CasAchAlySum").text(formatNumber(item.PicAchAly.toFixed(2)));
                    $("#CasScrAlySum").text(formatNumber(item.PicScrAly.toFixed(2)));
                    var PicGrdAly = item.PicGrdAly;
                    if (PicGrdAly == 0)
                        $("#AlyTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorAly = item.PicScrAly - item.PicGrdAly;
                        if (newcolorAly >= 0 && item.PicTgtAly > 0)
                            $("#AlyTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#AlyTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrAly;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdAly;

                    //---- Silica
                    $("#CasGrdSilSum").text(formatNumber(item.PicGrdSil));
                    $("#CasTgtSilSum").text(formatNumber(item.PicTgtSil));
                    $("#CasActSilSum").text(formatNumber(item.PicActSil));
                    $("#CasAchSilSum").text(formatNumber(item.PicAchSil.toFixed(2)));
                    $("#CasScrSilSum").text(formatNumber(item.PicScrSil.toFixed(2)));
                    var PicGrdSil = item.PicGrdSil;
                    if (PicGrdSil == 0)
                        $("#SilTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorSil = item.PicScrSil - item.PicGrdSil;
                        if (newcolorSil >= 0 && item.PicTgtSil > 0)
                            $("#SilTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#SilTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrSil;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdSil;

                    //---- Zircon Flour
                    $("#CasGrdZifSum").text(formatNumber(item.PicGrdZif));
                    $("#CasTgtZifSum").text(formatNumber(item.PicTgtZif));
                    $("#CasActZifSum").text(formatNumber(item.PicActZif));
                    $("#CasAchZifSum").text(formatNumber(item.PicAchZif.toFixed(2)));
                    $("#CasScrZifSum").text(formatNumber(item.PicScrZif.toFixed(2)));
                    var PicGrdZif = item.PicGrdZif;
                    if (PicGrdZif == 0)
                        $("#ZifTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorZif = item.PicScrZif - item.PicGrdZif;
                        if (newcolorZif >= 0 && item.PicTgtZif > 0)
                            $("#ZifTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#ZifTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrZif;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdZif;

                    //---- Zircon Sads
                    $("#CasGrdZisSum").text(formatNumber(item.PicGrdZis));
                    $("#CasTgtZisSum").text(formatNumber(item.PicTgtZis));
                    $("#CasActZisSum").text(formatNumber(item.PicActZis));
                    $("#CasAchZisSum").text(formatNumber(item.PicAchZis.toFixed(2)));
                    $("#CasScrZisSum").text(formatNumber(item.PicScrZis.toFixed(2)));
                    var PicGrdZis = item.PicGrdZis;
                    if (PicGrdZis == 0)
                        $("#ZisTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorZis = item.PicScrZis - item.PicGrdZis;
                        if (newcolorZis >= 0 && item.PicTgtZis > 0)
                            $("#ZisTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#ZisTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrZis;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdZis;

                    //---- Mullite Flour
                    $("#CasGrdMufSum").text(formatNumber(item.PicGrdMuf));
                    $("#CasTgtMufSum").text(formatNumber(item.PicTgtMuf));
                    $("#CasActMufSum").text(formatNumber(item.PicActMuf));
                    $("#CasAchMufSum").text(formatNumber(item.PicAchMuf.toFixed(2)));
                    $("#CasScrMufSum").text(formatNumber(item.PicScrMuf.toFixed(2)));
                    var PicGrdMuf = item.PicGrdMuf;
                    if (PicGrdMuf == 0)
                        $("#MufTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorMuf = item.PicScrMuf - item.PicGrdMuf;
                        if (newcolorMuf >= 0 && item.PicTgtMuf > 0)
                            $("#MufTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#MufTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrMuf;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdMuf;

                    //---- Mullite Sands 30-80
                    $("#CasGrdMu3Sum").text(formatNumber(item.PicGrdMu3));
                    $("#CasTgtMu3Sum").text(formatNumber(item.PicTgtMu3));
                    $("#CasActMu3Sum").text(formatNumber(item.PicActMu3));
                    $("#CasAchMu3Sum").text(formatNumber(item.PicAchMu3.toFixed(2)));
                    $("#CasScrMu3Sum").text(formatNumber(item.PicScrMu3.toFixed(2)));
                    var PicGrdMu3 = item.PicGrdMu3;
                    if (PicGrdMu3 == 0)
                        $("#Mu3TitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorMu3 = item.PicScrMu3 - item.PicGrdMu3;
                        if (newcolorMu3 >= 0 && item.PicTgtMu3 > 0)
                            $("#Mu3TitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#Mu3TitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrMu3;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdMu3;

                    //---- Mullite Sands 15-30
                    $("#CasGrdMu1Sum").text(formatNumber(item.PicGrdMu1));
                    $("#CasTgtMu1Sum").text(formatNumber(item.PicTgtMu1));
                    $("#CasActMu1Sum").text(formatNumber(item.PicActMu1));
                    $("#CasAchMu1Sum").text(formatNumber(item.PicAchMu1.toFixed(2)));
                    $("#CasScrMu1Sum").text(formatNumber(item.PicScrMu1.toFixed(2)));
                    var PicGrdMu1 = item.PicGrdMu1;
                    if (PicGrdMu1 == 0)
                        $("#Mu1TitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolorMu1 = item.PicScrMu1 - item.PicGrdMu1;
                        if (newcolorMu1 >= 0 && item.PicTgtMu1 > 0)
                            $("#Mu1TitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#Mu1TitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    PicScrTotSum = PicScrTotSum + item.PicScrMu1;
                    PicTotGradeSum = PicTotGradeSum + item.PicGrdMu1;



                    /*--------------total-----------------------*/
                    $("#PicScrTotSum").text(formatNumber(PicScrTotSum.toFixed(2)));
                    $("#PicGrdTotSum").text(formatNumber(PicTotGradeSum.toFixed(2)));
                });
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            },
            beforeSend: function () { $(".loader").show(); },
            complete: function () { $(".loader").hide(); },
            type: 'POST', dataType: 'json'
        });

  
    }


</script>