<style>
    body, html {
        height: 100%;
    }

    body {
        margin: 0;
        padding: 0;
        border: 0;
    }

    .footer {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 30px;
        background-color: #f5f5f5;
    }

    table, th, td {
        border: 1px solid black;
        border-collapse: collapse;
    }

    th, td {
        padding: 5px;
        text-align: left;
    }

    p {
        text-orientation: upright;
        writing-mode: vertical-lr;
    }

    centerP {
        display: flex;
        justify-content: center;
        align-items: center;
        writing-mode: vertical-lr;
        text-orientation: upright;
        height: 50em;
    }

    .loader {
        position: fixed;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        z-index: 9999;
        background: Url("/Content/images/pageLoader.gif") 50% 50% no-repeat rgb(249,249,249);
        opacity: .8;
    }
</style>

@{
    ViewBag.Title = "Dashboard";
    Layout = "~/Views/Shared/_Layout.cshtml";

}

<body>
    <div class="container">
        <br />
        <div class="row">
            <div class="col-sm-2">
                <label for="lbl1">Periode :</label>
            </div>
            <div class="col-sm-2">
                @if (Session["UserType"] != null)
                {
                    var author = Session["UserType"];
                    <input type="hidden" class="form-control" id="authorid" placeholder="YYYY" value=@author />
                }
                <div class="input-group date datetimepicker">
                    <input type="text" class="form-control" id="prd" placeholder="YYYY" />
                    <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                </div>

            </div>
            <div class="col-sm-2">
                <button id="periode" type="button" class="btn btn-danger btn-md" data-toggle="tooltip" title="View" onclick="GetPeriode();">Table</button>
            </div>
            <div class="col-sm-4">
                <select class="form-control" id="monthkpi">
                    <option value="1">JANUARY</option>
                    <option value="2">FEBRUARY</option>
                    <option value="3">MARCH</option>
                    <option value="4">APRIL</option>
                    <option value="5">MAY</option>
                    <option value="6">JUNE</option>
                    <option value="7">JULY</option>
                    <option value="8">AUGUSTUS</option>
                    <option value="9">SEPTEMBER</option>
                    <option value="10">OCTOBER</option>
                    <option value="11">NOVEMBER</option>
                    <option value="12">DECEMBER</option>
                </select>
            </div>
            <div class="col-sm-2">
                <button id="month" type="button" class="btn btn-danger btn-md" data-toggle="tooltip" title="View" onclick="GetMonth();">Table</button>
            </div>
        </div>
        <br />
        <div id="detailForm" class="form-horizontal">
            <br />
            <table id="DetailInfo" class="table table-bordered  table-hover">
                <caption id="thn" class="text-center" style="background-color: #4d79ff;color: white;">Year :</caption>
                <tbody id="tbodytblDetailInfo">
                    <tr>
                        <th style="background-color: #4d79ff;color: white;"><b>DEPARTMENT</b></th>
                        <th style="background-color: #4d79ff;color: white;"><b>DESCRIPTION</b></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>WEIGHT</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>TARGET</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>ACTUAL</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>ACHIEVEMENT</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>SCORE</b></span></th>
                    </tr>
                    <tr>
                        <th rowspan="9" class="text-center"><a href="javascript:void(0)" data-toggle="tooltip" title="Monthly" onclick="Monthly()"><b>PURCHASING</b></a></th>
                        <td><span id="RevTitle">Revenue</span></td>
                        <td><span id="PurGrdRev" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtRev" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActRev" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchRev" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrRev" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="PdaTitle">Production Output PDA</span></td>
                        <td><span id="PurGrdPda" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtPda" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActPda" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchPda" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrPda" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="PdcTitle">Production Output PDB+PDC</span></td>
                        <td><span id="PurGrdPdc" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtPdc" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActPdc" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchPdc" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrPdc" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="AllTitle">Total Purchase For All excl Assets (%)</span></td>
                        <td><span id="PurGrdAll" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtAll" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActAll" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchAll" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrAll" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="DrmTitle">Supplier DRM (%)</span></td>
                        <td><span id="PurGrdDrm" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtDrm" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActDrm" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchDrm" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrDrm" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="QrmTitle">Supplier QRM (%)</span></td>
                        <td><span id="PurGrdQrm" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtQrm" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActQrm" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchQrm" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrQrm" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="CosTitle">Cost Saving from Purchase</span></td>
                        <td><span id="PurGrdCos" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtCos" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActCos" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchCos" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrCos" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="PayTitle">Payment Term</span></td>
                        <td><span id="PurGrdPay" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtPay" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActPay" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchPay" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrPay" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span class="pull-right" style="color:blue"><b>Total Weight</b></span></td>
                        <td><span id="PicGrdTot" class="pull-right" style="color:blue;font-weight:bold"></span></td>
                        <td><span></span></td>
                        <td><span></span></td>
                        <td><span class="pull-right" style="color:blue"><b>Total Score</b></span></td>
                        <td><span id="PicScrTot" class="pull-right" style="color:blue;font-weight:bold"></span></td>
                    </tr>
                </tbody>
            </table>
            <br />
            <br />
            <br />
            <br />
        </div>

        <div id="monthlyForm" class="form-horizontal">
            <br />
            <table id="monthlyInfo" class="table table-bordered  table-hover">
                <caption id="blnnan" class="text-center" style="background-color: #4d79ff;color: white;">MONTH : </caption>
                <tbody id="tbodytblMonthlyInfo">
                    <tr>
                        <th style="background-color: #4d79ff;color: white;"><b>DEPARTMENT</b></th>
                        <th style="background-color: #4d79ff;color: white;"><b>DESCRIPTION</b></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>WEIGHT</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>TARGET</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>ACTUAL</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>ACHIEVEMENT</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>SCORE</b></span></th>
                    </tr>
                    <tr>
                        <th rowspan="9" class="text-center"><a href="javascript:void(0)" data-toggle="tooltip" title="Monthly" onclick="Yearly()"><b>PURCHASING</b></a></th>
                        <td><span id="RevTitleMonth">Revenue</span></td>
                        <td><span id="PurGrdRevMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtRevMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActRevMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchRevMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrRevMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="PdaTitleMonth">Production Output PDA</span></td>
                        <td><span id="PurGrdPdaMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtPdaMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActPdaMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchPdaMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrPdaMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="PdcTitleMonth">Production Output PDB+PDC</span></td>
                        <td><span id="PurGrdPdcMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtPdcMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActPdcMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchPdcMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrPdcMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="AllTitleMonth">Total Purchase For All excl Assets (%)</span></td>
                        <td><span id="PurGrdAllMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtAllMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActAllMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchAllMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrAllMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="DrmTitleMonth">Supplier DRM (%)</span></td>
                        <td><span id="PurGrdDrmMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtDrmMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActDrmMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchDrmMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrDrmMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="QrmTitleMonth">Supplier QRM (%)</span></td>
                        <td><span id="PurGrdQrmMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtQrmMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActQrmMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchQrmMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrQrmMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="CosTitleMonth">Cost Saving from Purchase</span></td>
                        <td><span id="PurGrdCosMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtCosMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActCosMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchCosMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrCosMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="PayTitleMonth">Payment Term</span></td>
                        <td><span id="PurGrdPayMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtPayMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActPayMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchPayMonth" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrPayMonth" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span class="pull-right" style="color:blue"><b>Total Weight</b></span></td>
                        <td><span id="PicGrdTotMonth" class="pull-right" style="color:blue;font-weight:bold"></span></td>
                        <td><span></span></td>
                        <td><span></span></td>
                        <td><span class="pull-right" style="color:blue"><b>Total Score</b></span></td>
                        <td><span id="PicScrTotMonth" class="pull-right" style="color:blue;font-weight:bold"></span></td>
                    </tr>

                </tbody>
            </table>
            <br />
            <br />
            <br />
            <br />
        </div>

        <div id="childForm" class="form-horizontal">
            <br />
            <table id="childInfo" class="table table-bordered  table-hover">
                <caption id="thnnan" class="text-center" style="background-color: #4d79ff;color: white;">YEAR TO DATE</caption>
                <tbody id="tbodytblChildInfo">
                    <tr>
                        <th style="background-color: #4d79ff;color: white;"><b>DEPARTMENT</b></th>
                        <th style="background-color: #4d79ff;color: white;"><b>DESCRIPTION</b></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>WEIGHT</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>TARGET</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>ACTUAL</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>ACHIEVEMENT</b></span></th>
                        <th style="background-color: #4d79ff;color: white;"><span class="pull-right"><b>SCORE</b></span></th>
                    </tr>
                    <tr>
                        <th rowspan="9" class="text-center"><b>PURCHASING</b></th>
                        <td><span id="RevTitleSum">Revenue</span></td>
                        <td><span id="PurGrdRevSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtRevSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActRevSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchRevSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrRevSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="PdaTitleSum">Production Output PDA</span></td>
                        <td><span id="PurGrdPdaSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtPdaSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActPdaSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchPdaSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrPdaSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="PdcTitleSum">Production Output PDB+PDC</span></td>
                        <td><span id="PurGrdPdcSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtPdcSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActPdcSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchPdcSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrPdcSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="AllTitleSum">Total Purchase For All excl Assets (%)</span></td>
                        <td><span id="PurGrdAllSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtAllSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActAllSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchAllSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrAllSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="DrmTitleSum">Supplier DRM (%)</span></td>
                        <td><span id="PurGrdDrmSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtDrmSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActDrmSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchDrmSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrDrmSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="QrmTitleSum">Supplier QRM (%)</span></td>
                        <td><span id="PurGrdQrmSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtQrmSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActQrmSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchQrmSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrQrmSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="CosTitleSum">Cost Saving from Purchase</span></td>
                        <td><span id="PurGrdCosSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtCosSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActCosSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchCosSum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrCosSum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span id="PayTitleSum">Payment Term</span></td>
                        <td><span id="PurGrdPaySum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurTgtPaySum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurActPaySum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurAchPaySum" class="pull-right" style="color:blue"></span></td>
                        <td><span id="PurScrPaySum" class="pull-right" style="color:blue"></span></td>
                    </tr>
                    <tr>
                        <td><span class="pull-right" style="color:blue"><b>Total Weight</b></span></td>
                        <td><span id="PicGrdTotSum" class="pull-right" style="color:blue;font-weight:bold"></span></td>
                        <td><span></span></td>
                        <td><span></span></td>
                        <td><span class="pull-right" style="color:blue"><b>Total Score</b></span></td>
                        <td><span id="PicScrTotSum" class="pull-right" style="color:blue;font-weight:bold"></span></td>
                    </tr>

                </tbody>
            </table>
            <br />
            <br />
            <br />
            <br />
        </div>
        <div class="loader"></div>
    </div>
</body>
<script>
    var urlKPI = "@Url.Content("~/Dashboard")";
    var PurScrRev = 0;
    var PurScrPda = 0;
    var PurScrPdc = 0;
    var PurScrAll = 0;
    var PurScrDrm = 0;
    var PurScrQrm = 0;
    var PurScrCos = 0;
    var PurScrPay = 0;
    var PicScrTot = 0;
    var PicScrTotMonth = 0;
    var PicScrTotSum = 0;
    var PicTotGrade = 0, PicTotGradeMonth = 0, PicTotGradeSum = 0;
    $(document).ready(function () {
        $('.datetimepicker').datetimepicker({
            format: 'YYYY'
        });
        $('#month').hide();
        $('#monthlyForm').hide();
        $('#childForm').hide();
        $('#monthkpi').hide();
        var userAu = $('#authorid').val();
        if (userAu == "VST") {
            $("#RevTitle").text('');
            $("#RevTitleMonth").text('');
            $("#RevTitleSum").text('');
        }

        var dNow = new Date()
        iMonth = dNow.getMonth() + 1
        var iYear = dNow.getFullYear()
        $('#prd').val(iYear);
        $('#thn').text('YEAR : ' + iYear);

        getView(iYear);
    });

    function GetPeriode() {
        var newyear = $('#prd').val();
        $('#thn').text('YEAR : ' + newyear);
        getView(newyear);
    }

    function GetMonth() {
        var newyear = $('#prd').val();
        var newmonth = $('#monthkpi').val();
        getMonthView(newyear, newmonth);
    }

    function Monthly() {
        $('#month').show();
        $('#monthlyForm').show();
        $('#childForm').show();
        $('#detailForm').hide();
        $('#periode').hide();
        $('#monthkpi').show();
    }

    function Yearly() {
        $('#month').hide();
        $('#monthlyForm').hide();
        $('#childForm').hide();
        $('#detailForm').show();
        $('#periode').show();
        $('#monthkpi').hide();
    }

    function valMonth(bl) {
        var nmonth;
        switch (bl) {
            case '1':
                nmonth = "JANUARY";
                break;
            case '2':
                nmonth = "FEBRUARY";
                break;
            case '3':
                nmonth = "MARCH";
                break;
            case '4':
                nmonth = "APRIL";
                break;
            case '5':
                nmonth = "MAY";
                break;
            case '6':
                nmonth = "JUNE";
                break;
            case '7':
                nmonth = "JULY";
                break;
            case '8':
                nmonth = "AUGUSTUS";
                break;
            case '9':
                nmonth = "SEPTEMBER";
                break;
            case '10':
                nmonth = "OCTOBER";
                break;
            case '11':
                nmonth = "NOVEMBER";
                break;
            case '12':
                nmonth = "DECEMBER";
                break;
            default:
                nmonth = "KABISAT";
                // code block
        }
        return nmonth;
    }

    function getView(thn) {
        PicScrTot = 0;
        PicTotGrade = 0;
        var userAu = $('#authorid').val();
        var kpiObj = {
            id: thn,
            bln: iMonth
        }
        $.ajax({
            url: urlKPI + "/vPurchasingDept/",
            data: JSON.stringify(kpiObj),
            contentType: "application/json;charset=utf-8",
            success: function (result) {
                $.each(result, function (key, item) {
                    //Revenue
                    if (userAu != "VST") {
                        $("#PurGrdRev").text(formatNumber(item.PicGrdRev));
                        $("#PurTgtRev").text(formatNumber(item.PicTgtRev));
                        $("#PurActRev").text(formatNumber(item.PicActRev));
                        $("#PurAchRev").text(formatNumber(item.PicAchRev.toFixed(2)));
                        $("#PurScrRev").text(formatNumber(item.PicScrRev.toFixed(2)));
                        var PicGrdRev = item.PicGrdRev;
                        if (PicGrdRev == 0)
                            $("#RevTitle").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor = item.PicScrRev - item.PicGrdRev;
                            if (newcolor >= 0)
                                $("#RevTitle").css({ "color": "black", "font-weight": "bold" });
                            else $("#RevTitle").css({ "color": "red", "font-weight": "bold" });
                        }
                    }
                    /*------------pda---------*/
                    $("#PurGrdPda").text(formatNumber(item.PicGrdPda));
                    $("#PurTgtPda").text(formatNumber(item.PicTgtPda));
                    $("#PurActPda").text(formatNumber(item.PicActPda));
                    $("#PurAchPda").text(formatNumber(item.PicAchPda.toFixed(2)));
                    $("#PurScrPda").text(formatNumber(item.PicScrPda.toFixed(2)));
                    var PicGrdPda = item.PicGrdPda;
                    if (PicGrdPda == 0)
                        $("#PdaTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor1 = item.PicScrPda - item.PicGrdPda;
                        if (newcolor1 >= 0 )
                            $("#PdaTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#PdaTitle").css({ "color": "red", "font-weight": "bold" });
                    }


                    /*------------pdc---------*/
                    $("#PurGrdPdc").text(formatNumber(item.PicGrdPdc));
                    $("#PurTgtPdc").text(formatNumber(item.PicTgtPdc));
                    $("#PurActPdc").text(formatNumber(item.PicActPdc));
                    $("#PurAchPdc").text(formatNumber(item.PicAchPdc.toFixed(2)));
                    $("#PurScrPdc").text(formatNumber(item.PicScrPdc.toFixed(2)));
                    var PicGrdPdc = item.PicGrdPdc;
                    if (PicGrdPdc == 0)
                        $("#PdcTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor2 = item.PicScrPdc - item.PicGrdPdc;
                        if (newcolor2 >= 0 )
                            $("#PdcTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#PdcTitle").css({ "color": "red", "font-weight": "bold" });
                    }


                    /*------------purch---------*/
                    $("#PurGrdAll").text(formatNumber(item.PicGrdInv));
                    $("#PurTgtAll").text(formatNumber(item.PicTgtInv));
                    $("#PurActAll").text(formatNumber(item.PicActInv));
                    $("#PurAchAll").text(formatNumber(item.PicAchInv.toFixed(2)));
                    $("#PurScrAll").text(formatNumber(item.PicScrInv.toFixed(2)));
                    var PicGrdInv = item.PicGrdInv;
                    if (PicGrdInv == 0)
                        $("#AllTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor3 = item.PicScrInv - item.PicGrdInv;
                        if (newcolor3 >= 0)
                            $("#AllTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#AllTitle").css({ "color": "red", "font-weight": "bold" });
                    }


                    /*------------Drm---------*/
                    $("#PurGrdDrm").text(formatNumber(item.PicGrdAir));
                    $("#PurTgtDrm").text(formatNumber(item.PicTgtAir));
                    $("#PurActDrm").text(formatNumber(item.PicActAir));
                    $("#PurAchDrm").text(formatNumber(item.PicAchAir.toFixed(2)));
                    $("#PurScrDrm").text(formatNumber(item.PicScrAir.toFixed(2)));
                    var PicGrdAir = item.PicGrdAir;
                    if (PicGrdAir == 0)
                        $("#DrmTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor4 = item.PicScrAir - item.PicGrdAir;
                        if (newcolor4 >= 0)
                            $("#DrmTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#DrmTitle").css({ "color": "red", "font-weight": "bold" });
                    }


                    /*------------Qrm---------*/
                    $("#PurGrdQrm").text(formatNumber(item.PicGrdDpp));
                    $("#PurTgtQrm").text(formatNumber(item.PicTgtDpp));
                    $("#PurActQrm").text(formatNumber(item.PicActDpp));
                    $("#PurAchQrm").text(formatNumber(item.PicAchDpp.toFixed(2)));
                    $("#PurScrQrm").text(formatNumber(item.PicScrDpp.toFixed(2)));
                    var PicGrdDpp = item.PicGrdDpp;
                    if (PicGrdDpp == 0)
                        $("#QrmTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor5 = item.PicScrDpp - item.PicGrdDpp;
                        if (newcolor5 >= 0)
                            $("#QrmTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#QrmTitle").css({ "color": "red", "font-weight": "bold" });
                    }


                    /*------------reduction---------*/
                    $("#PurGrdCos").text(formatNumber(item.PicGrdEme));
                    $("#PurTgtCos").text(formatNumber(item.PicTgtEme));
                    $("#PurActCos").text(formatNumber(item.PicActEme));
                    $("#PurAchCos").text(formatNumber(item.PicAchEme.toFixed(2)));
                    $("#PurScrCos").text(formatNumber(item.PicScrEme.toFixed(2)));
                    var PicGrdEme = item.PicGrdEme;
                    if (PicGrdEme == 0)
                        $("#CosTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor6 = item.PicScrEme - item.PicGrdEme;
                        if (newcolor6 >= 0)
                            $("#CosTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#CosTitle").css({ "color": "red", "font-weight": "bold" });
                    }


                    /*------------payment---------*/
                    $("#PurGrdPay").text(formatNumber(item.PicGrdSca));
                    $("#PurTgtPay").text(formatNumber(item.PicTgtSca));
                    $("#PurActPay").text(formatNumber(item.PicActSca));
                    $("#PurAchPay").text(formatNumber(item.PicAchSca.toFixed(2)));
                    $("#PurScrPay").text(formatNumber(item.PicScrSca.toFixed(2)));
                    var PicGrdSca = item.PicGrdSca;
                    if (PicGrdSca == 0)
                        $("#PayTitle").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor7 = item.PicScrSca - item.PicGrdSca;
                        if (newcolor7 >= 0)
                            $("#PayTitle").css({ "color": "black", "font-weight": "bold" });
                        else $("#PayTitle").css({ "color": "red", "font-weight": "bold" });
                    }
                    if (userAu == "VST") {
                        PicScrTot = item.PicScrPda + item.PicScrPdc + item.PicScrInv + item.PicScrAir + item.PicScrDpp + item.PicScrEme + item.PicScrSca;
                        PicTotGrade = item.PicGrdPda + item.PicGrdPdc + item.PicGrdInv + item.PicGrdAir + item.PicGrdDpp + item.PicGrdEme + item.PicGrdSca;
                    } else {
                        PicScrTot = item.PicScrRev + item.PicScrPda + item.PicScrPdc + item.PicScrInv + item.PicScrAir + item.PicScrDpp + item.PicScrEme + item.PicScrSca;
                        PicTotGrade = item.PicGrdRev + item.PicGrdPda + item.PicGrdPdc + item.PicGrdInv + item.PicGrdAir + item.PicGrdDpp + item.PicGrdEme + item.PicGrdSca;
                    }
                    $("#PicScrTot").text(formatNumber(PicScrTot.toFixed(2)));
                    $("#PicGrdTot").text(formatNumber(PicTotGrade.toFixed(2)));

                });
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            },
            beforeSend: function () { $(".loader").show(); },
            complete: function () { $(".loader").hide(); },
            type: 'POST', dataType: 'json'
        });

    }

    function getMonthView(thn, bln) {
        PicScrTotMonth = 0;
        PicScrTotSum = 0;
        PicTotGradeMonth = 0;
        PicTotGradeSum = 0;
        var userAu = $('#authorid').val();
        var nmbulan = valMonth(bln);
        $('#blnnan').text('MONTH : ' + nmbulan + '-' + thn);

        var kpiObj = {
            id: thn,
            bln: bln,
            ch: "M"
        }
        $.ajax({
            url: urlKPI + "/vPurchasingDeptSummary/",
            data: JSON.stringify(kpiObj),
            contentType: "application/json;charset=utf-8",
            success: function (result) {
                $.each(result, function (key, item) {
                    //Revenue
                    if (userAu != "VST") {
                        $("#PurGrdRevMonth").text(formatNumber(item.PicGrdRev));
                        $("#PurTgtRevMonth").text(formatNumber(item.PicTgtRev));
                        $("#PurActRevMonth").text(formatNumber(item.PicActRev));
                        $("#PurAchRevMonth").text(formatNumber(item.PicAchRev.toFixed(2)));
                        $("#PurScrRevMonth").text(formatNumber(item.PicScrRev.toFixed(2)));
                        var PicGrdRev = item.PicGrdRev;
                        if (PicGrdRev == 0)
                            $("#RevTitleMonth").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor = item.PicScrRev - item.PicGrdRev;
                            if (newcolor >= 0)
                                $("#RevTitleMonth").css({ "color": "black", "font-weight": "bold" });
                            else $("#RevTitleMonth").css({ "color": "red", "font-weight": "bold" });
                        }
                    }
                    /*------------pda---------*/
                    $("#PurGrdPdaMonth").text(formatNumber(item.PicGrdPda));
                    $("#PurTgtPdaMonth").text(formatNumber(item.PicTgtPda));
                    $("#PurActPdaMonth").text(formatNumber(item.PicActPda));
                    $("#PurAchPdaMonth").text(formatNumber(item.PicAchPda.toFixed(2)));
                    $("#PurScrPdaMonth").text(formatNumber(item.PicScrPda.toFixed(2)));
                    var PicGrdPda = item.PicGrdPda;
                    if (PicGrdPda == 0)
                        $("#PdaTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor1 = item.PicScrPda - item.PicGrdPda;
                        if (newcolor1 >= 0)
                            $("#PdaTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#PdaTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }

                    /*------------pdc---------*/
                    $("#PurGrdPdcMonth").text(formatNumber(item.PicGrdPdc));
                    $("#PurTgtPdcMonth").text(formatNumber(item.PicTgtPdc));
                    $("#PurActPdcMonth").text(formatNumber(item.PicActPdc));
                    $("#PurAchPdcMonth").text(formatNumber(item.PicAchPdc.toFixed(2)));
                    $("#PurScrPdcMonth").text(formatNumber(item.PicScrPdc.toFixed(2)));
                    var PicGrdPdc = item.PicGrdPdc;
                    if (PicGrdPdc == 0)
                        $("#PdcTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor2 = item.PicScrPdc - item.PicGrdPdc;
                        if (newcolor2 >= 0)
                            $("#PdcTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#PdcTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }

                    /*------------purch---------*/
                    $("#PurGrdAllMonth").text(formatNumber(item.PicGrdInv));
                    $("#PurTgtAllMonth").text(formatNumber(item.PicTgtInv));
                    $("#PurActAllMonth").text(formatNumber(item.PicActInv));
                    $("#PurAchAllMonth").text(formatNumber(item.PicAchInv.toFixed(2)));
                    $("#PurScrAllMonth").text(formatNumber(item.PicScrInv.toFixed(2)));
                    var PicGrdInv = item.PicGrdInv;
                    if (PicGrdInv == 0)
                        $("#AllTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor3 = item.PicScrInv - item.PicGrdInv;
                        if (newcolor3 >= 0)
                            $("#AllTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#AllTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }

                    /*------------Drm---------*/
                    $("#PurGrdDrmMonth").text(formatNumber(item.PicGrdAir));
                    $("#PurTgtDrmMonth").text(formatNumber(item.PicTgtAir));
                    $("#PurActDrmMonth").text(formatNumber(item.PicActAir));
                    $("#PurAchDrmMonth").text(formatNumber(item.PicAchAir.toFixed(2)));
                    $("#PurScrDrmMonth").text(formatNumber(item.PicScrAir.toFixed(2)));
                    var PicGrdAir = item.PicGrdAir;
                    if (PicGrdAir == 0)
                        $("#DrmTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor4 = item.PicScrAir - item.PicGrdAir;
                        if (newcolor4 >= 0)
                            $("#DrmTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#DrmTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }

                    /*------------Qrm---------*/
                    $("#PurGrdQrmMonth").text(formatNumber(item.PicGrdDpp));
                    $("#PurTgtQrmMonth").text(formatNumber(item.PicTgtDpp));
                    $("#PurActQrmMonth").text(formatNumber(item.PicActDpp));
                    $("#PurAchQrmMonth").text(formatNumber(item.PicAchDpp.toFixed(2)));
                    $("#PurScrQrmMonth").text(formatNumber(item.PicScrDpp.toFixed(2)));
                    var PicGrdDpp = item.PicGrdDpp;
                    if (PicGrdDpp == 0)
                        $("#QrmTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor5 = item.PicScrDpp - item.PicGrdDpp;
                        if (newcolor5 >= 0)
                            $("#QrmTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#QrmTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }

                    /*------------reduction---------*/
                    $("#PurGrdCosMonth").text(formatNumber(item.PicGrdEme));
                    $("#PurTgtCosMonth").text(formatNumber(item.PicTgtEme));
                    $("#PurActCosMonth").text(formatNumber(item.PicActEme));
                    $("#PurAchCosMonth").text(formatNumber(item.PicAchEme.toFixed(2)));
                    $("#PurScrCosMonth").text(formatNumber(item.PicScrEme.toFixed(2)));
                    var PicGrdEme = item.PicGrdEme;
                    if (PicGrdEme == 0)
                        $("#CosTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor6 = item.PicScrEme - item.PicGrdEme;
                        if (newcolor6 >= 0)
                            $("#CosTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#CosTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }

                    /*------------payment---------*/
                    $("#PurGrdPayMonth").text(formatNumber(item.PicGrdSca));
                    $("#PurTgtPayMonth").text(formatNumber(item.PicTgtSca));
                    $("#PurActPayMonth").text(formatNumber(item.PicActSca));
                    $("#PurAchPayMonth").text(formatNumber(item.PicAchSca.toFixed(2)));
                    $("#PurScrPayMonth").text(formatNumber(item.PicScrSca.toFixed(2)));
                    var PicGrdSca = item.PicGrdSca;
                    if (PicGrdSca == 0)
                        $("#PayTitleMonth").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor7 = item.PicScrSca - item.PicGrdSca;
                        if (newcolor7 >= 0)
                            $("#PayTitleMonth").css({ "color": "black", "font-weight": "bold" });
                        else $("#PayTitleMonth").css({ "color": "red", "font-weight": "bold" });
                    }

                    if (userAu == "VST") {
                        PicScrTotMonth = item.PicScrPda + item.PicScrPdc + item.PicScrInv + item.PicScrAir + item.PicScrDpp + item.PicScrEme + item.PicScrSca;
                        PicTotGradeMonth = item.PicGrdPda + item.PicGrdPdc + item.PicGrdInv + item.PicGrdAir + item.PicGrdDpp + item.PicGrdEme + item.PicGrdSca;
                    }
                    else {
                        PicScrTotMonth = item.PicScrRev + item.PicScrPda + item.PicScrPdc + item.PicScrInv + item.PicScrAir + item.PicScrDpp + item.PicScrEme + item.PicScrSca;
                        PicTotGradeMonth = item.PicGrdRev + item.PicGrdPda + item.PicGrdPdc + item.PicGrdInv + item.PicGrdAir + item.PicGrdDpp + item.PicGrdEme + item.PicGrdSca;
                    }

                    $("#PicScrTotMonth").text(formatNumber(PicScrTotMonth.toFixed(2)));
                    $("#PicGrdTotMonth").text(formatNumber(PicTotGradeMonth.toFixed(2)));

                });
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            },
            beforeSend: function () { $(".loader").show(); },
            complete: function () { $(".loader").hide(); },
            type: 'POST', dataType: 'json'
        });

        var kpiObj = {
            id: thn,
            bln: bln,
            ch: "Y"
        }
        $.ajax({
            url: urlKPI + "/vPurchasingDeptSummary/",
            data: JSON.stringify(kpiObj),
            contentType: "application/json;charset=utf-8",
            success: function (result) {
                $.each(result, function (key, item) {
                    //Revenue
                    if (userAu != "VST") {
                        $("#PurGrdRevSum").text(formatNumber(item.PicGrdRev));
                        $("#PurTgtRevSum").text(formatNumber(item.PicTgtRev));
                        $("#PurActRevSum").text(formatNumber(item.PicActRev));
                        $("#PurAchRevSum").text(formatNumber(item.PicAchRev.toFixed(2)));
                        $("#PurScrRevSum").text(formatNumber(item.PicScrRev.toFixed(2)));
                        var PicGrdRev = item.PicGrdRev;
                        if (PicGrdRev == 0)
                            $("#RevTitleSum").css({ "color": "black", "font-weight": "normal" });
                        else {
                            var newcolor = item.PicScrRev - item.PicGrdRev;
                            if (newcolor >= 0)
                                $("#RevTitleSum").css({ "color": "black", "font-weight": "bold" });
                            else $("#RevTitleSum").css({ "color": "red", "font-weight": "bold" });
                        }
                    }
                    /*------------pda---------*/
                    $("#PurGrdPdaSum").text(formatNumber(item.PicGrdPda));
                    $("#PurTgtPdaSum").text(formatNumber(item.PicTgtPda));
                    $("#PurActPdaSum").text(formatNumber(item.PicActPda));
                    $("#PurAchPdaSum").text(formatNumber(item.PicAchPda.toFixed(2)));
                    $("#PurScrPdaSum").text(formatNumber(item.PicScrPda.toFixed(2)));
                    var PicGrdPda = item.PicGrdPda;
                    if (PicGrdPda == 0)
                        $("#PdaTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor1 = item.PicScrPda - item.PicGrdPda;
                        if (newcolor1 >= 0)
                            $("#PdaTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#PdaTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }

                    /*------------pdc---------*/
                    $("#PurGrdPdcSum").text(formatNumber(item.PicGrdPdc));
                    $("#PurTgtPdcSum").text(formatNumber(item.PicTgtPdc));
                    $("#PurActPdcSum").text(formatNumber(item.PicActPdc));
                    $("#PurAchPdcSum").text(formatNumber(item.PicAchPdc.toFixed(2)));
                    $("#PurScrPdcSum").text(formatNumber(item.PicScrPdc.toFixed(2)));
                    var PicGrdPdc = item.PicGrdPdc;
                    if (PicGrdPdc == 0)
                        $("#PdcTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor2 = item.PicScrPdc - item.PicGrdPdc;
                        if (newcolor2 >= 0)
                            $("#PdcTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#PdcTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }

                    /*------------purch---------*/
                    $("#PurGrdAllSum").text(formatNumber(item.PicGrdInv));
                    $("#PurTgtAllSum").text(formatNumber(item.PicTgtInv));
                    $("#PurActAllSum").text(formatNumber(item.PicActInv));
                    $("#PurAchAllSum").text(formatNumber(item.PicAchInv.toFixed(2)));
                    $("#PurScrAllSum").text(formatNumber(item.PicScrInv.toFixed(2)));
                    var PicGrdInv = item.PicGrdInv;
                    if (PicGrdInv == 0)
                        $("#AllTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor3 = item.PicScrInv - item.PicGrdInv;
                        if (newcolor3 >= 0)
                            $("#AllTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#AllTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }

                    /*------------Drm---------*/
                    $("#PurGrdDrmSum").text(formatNumber(item.PicGrdAir));
                    $("#PurTgtDrmSum").text(formatNumber(item.PicTgtAir));
                    $("#PurActDrmSum").text(formatNumber(item.PicActAir));
                    $("#PurAchDrmSum").text(formatNumber(item.PicAchAir.toFixed(2)));
                    $("#PurScrDrmSum").text(formatNumber(item.PicScrAir.toFixed(2)));
                    var PicGrdAir = item.PicGrdAir;
                    if (PicGrdAir == 0)
                        $("#DrmTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor4 = item.PicScrAir - item.PicGrdAir;
                        if (newcolor4 >= 0)
                            $("#DrmTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#DrmTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }

                    /*------------Qrm---------*/
                    $("#PurGrdQrmSum").text(formatNumber(item.PicGrdDpp));
                    $("#PurTgtQrmSum").text(formatNumber(item.PicTgtDpp));
                    $("#PurActQrmSum").text(formatNumber(item.PicActDpp));
                    $("#PurAchQrmSum").text(formatNumber(item.PicAchDpp.toFixed(2)));
                    $("#PurScrQrmSum").text(formatNumber(item.PicScrDpp.toFixed(2)));
                    var PicGrdDpp = item.PicGrdDpp;
                    if (PicGrdDpp == 0)
                        $("#QrmTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor5 = item.PicScrDpp - item.PicGrdDpp;
                        if (newcolor5 >= 0)
                            $("#QrmTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#QrmTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }

                    /*------------reduction---------*/
                    $("#PurGrdCosSum").text(formatNumber(item.PicGrdEme));
                    $("#PurTgtCosSum").text(formatNumber(item.PicTgtEme));
                    $("#PurActCosSum").text(formatNumber(item.PicActEme));
                    $("#PurAchCosSum").text(formatNumber(item.PicAchEme.toFixed(2)));
                    $("#PurScrCosSum").text(formatNumber(item.PicScrEme.toFixed(2)));
                    var PicGrdEme = item.PicGrdEme;
                    if (PicGrdEme == 0)
                        $("#CosTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor6 = item.PicScrEme - item.PicGrdEme;
                        if (newcolor6 >= 0)
                            $("#CosTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#CosTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }

                    /*------------payment---------*/
                    $("#PurGrdPaySum").text(formatNumber(item.PicGrdSca));
                    $("#PurTgtPaySum").text(formatNumber(item.PicTgtSca));
                    $("#PurActPaySum").text(formatNumber(item.PicActSca));
                    $("#PurAchPaySum").text(formatNumber(item.PicAchSca.toFixed(2)));
                    $("#PurScrPaySum").text(formatNumber(item.PicScrSca.toFixed(2)));
                    var PicGrdSca = item.PicGrdSca;
                    if (PicGrdSca == 0)
                        $("#PayTitleSum").css({ "color": "black", "font-weight": "normal" });
                    else {
                        var newcolor7 = item.PicScrSca - item.PicGrdSca;
                        if (newcolor7 >= 0)
                            $("#PayTitleSum").css({ "color": "black", "font-weight": "bold" });
                        else $("#PayTitleSum").css({ "color": "red", "font-weight": "bold" });
                    }
                    if (userAu != "VST") {
                        PicScrTotSum = item.PicScrRev + item.PicScrPda + item.PicScrPdc + item.PicScrInv + item.PicScrAir + item.PicScrDpp + item.PicScrEme + item.PicScrSca;
                        PicTotGradeSum = item.PicGrdRev + item.PicGrdPda + item.PicGrdPdc + item.PicGrdInv + item.PicGrdAir + item.PicGrdDpp + item.PicGrdEme + item.PicGrdSca;
                    }
                    else {
                        PicScrTotSum =  item.PicScrPda + item.PicScrPdc + item.PicScrInv + item.PicScrAir + item.PicScrDpp + item.PicScrEme + item.PicScrSca;
                        PicTotGradeSum = item.PicGrdPda + item.PicGrdPdc + item.PicGrdInv + item.PicGrdAir + item.PicGrdDpp + item.PicGrdEme + item.PicGrdSca;
                    }
                    $("#PicScrTotSum").text(formatNumber(PicScrTotSum.toFixed(2)));
                    $("#PicGrdTotSum").text(formatNumber(PicTotGradeSum.toFixed(2)));

                });
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            },
            beforeSend: function () { $(".loader").show(); },
            complete: function () { $(".loader").hide(); },
            type: 'POST', dataType: 'json'
        });

    }



    function formatNumber(num) {
        return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,")
    }

</script>